[2015-08-10 12:27:38,635] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:3,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 24 from controller 2 epoch 6 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:27:38,636] TRACE Broker 1 handling LeaderAndIsr request correlationId 24 from controller 2 epoch 6 starting the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:27:38,636] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 2 epoch 6 with correlation id 24 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:27:38,636] TRACE Broker 1 completed LeaderAndIsr request correlationId 24 from controller 2 epoch 6 for the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:27:38,642] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:3,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 2 epoch 6 with correlation id 24 (state.change.logger)
[2015-08-10 12:27:38,645] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:2,1,LeaderEpoch:10,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 26 from controller 2 epoch 6 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:27:38,645] TRACE Broker 1 handling LeaderAndIsr request correlationId 26 from controller 2 epoch 6 starting the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:27:38,645] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 2 epoch 6 with correlation id 26 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:27:38,645] TRACE Broker 1 completed LeaderAndIsr request correlationId 26 from controller 2 epoch 6 for the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:27:38,649] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:2,1,LeaderEpoch:10,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 2 epoch 6 with correlation id 26 (state.change.logger)
[2015-08-10 12:27:38,649] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:4,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 27 from controller 2 epoch 6 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:27:38,649] TRACE Broker 1 handling LeaderAndIsr request correlationId 27 from controller 2 epoch 6 starting the become-leader transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:27:38,649] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 2 epoch 6 with correlation id 27 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:27:38,649] TRACE Broker 1 completed LeaderAndIsr request correlationId 27 from controller 2 epoch 6 for the become-leader transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:27:38,852] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:4,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 2 epoch 6 with correlation id 27 (state.change.logger)
[2015-08-10 12:27:38,853] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:4,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 29 from controller 2 epoch 6 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:27:38,853] TRACE Broker 1 handling LeaderAndIsr request correlationId 29 from controller 2 epoch 6 starting the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:27:38,853] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 29 from controller 2 epoch 6 for partition [messages-replicated-part3,0] since the new leader 2 is the same as the old leader (state.change.logger)
[2015-08-10 12:27:38,853] TRACE Broker 1 completed LeaderAndIsr request correlationId 29 from controller 2 epoch 6 for the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:27:38,854] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:4,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 2 epoch 6 with correlation id 29 (state.change.logger)
[2015-08-10 12:27:39,021] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 30 from controller 2 epoch 6 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:27:39,022] TRACE Broker 1 handling LeaderAndIsr request correlationId 30 from controller 2 epoch 6 starting the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:27:39,022] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 2 epoch 6 with correlation id 30 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:27:39,022] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition [messages-replicated,0] as part of become-follower request with correlation id 30 from controller 2 epoch 6 (state.change.logger)
[2015-08-10 12:27:39,024] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 30 from controller 2 epoch 6 for partition [messages-replicated,0] since it is shutting down (state.change.logger)
[2015-08-10 12:27:39,024] TRACE Broker 1 completed LeaderAndIsr request correlationId 30 from controller 2 epoch 6 for the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:27:39,025] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 2 epoch 6 with correlation id 30 (state.change.logger)
[2015-08-10 12:27:39,030] TRACE Broker 1 handling stop replica (delete=false) for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:27:39,031] TRACE Broker 1 finished handling stop replica (delete=false) for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:27:39,033] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 2 epoch 6 with correlation id 32 (state.change.logger)
[2015-08-10 12:27:39,219] TRACE Broker 1 handling stop replica (delete=false) for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:27:39,219] TRACE Broker 1 finished handling stop replica (delete=false) for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,118] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,131] ERROR Controller 0 epoch 7 initiated state change for partition [messages-replicated,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [messages-replicated,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 12:28:09,134] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,140] ERROR Controller 0 epoch 7 initiated state change for partition [messages-replicated-part3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [messages-replicated-part3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 0, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 12:28:09,141] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,147] ERROR Controller 0 epoch 7 initiated state change for partition [messages-replicated-part3,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [messages-replicated-part3,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 1, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 12:28:09,148] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,153] ERROR Controller 0 epoch 7 initiated state change for partition [messages-replicated-part3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [messages-replicated-part3,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 12:28:09,154] TRACE Controller 0 epoch 7 started leader election for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,160] ERROR Controller 0 epoch 7 initiated state change for partition [messages,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [messages,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 12:28:09,229] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6) with correlationId 3 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,230] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6) with correlationId 3 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,230] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6) with correlationId 3 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,230] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6) with correlationId 3 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,230] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6) with correlationId 3 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,238] TRACE Controller 0 epoch 7 changed state of replica 0 for partition [messages-replicated,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:28:09,239] TRACE Controller 0 epoch 7 changed state of replica 0 for partition [messages,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:28:09,239] TRACE Controller 0 epoch 7 changed state of replica 0 for partition [messages-replicated-part3,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:28:09,239] TRACE Controller 0 epoch 7 changed state of replica 0 for partition [messages-replicated-part3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:28:09,240] TRACE Controller 0 epoch 7 changed state of replica 0 for partition [messages-replicated-part3,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:28:09,242] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6) with correlationId 4 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,242] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6) with correlationId 4 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,243] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6) with correlationId 4 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,243] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6) with correlationId 4 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,243] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6) with correlationId 4 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,243] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6) with correlationId 4 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,243] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6) with correlationId 4 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,244] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6) with correlationId 4 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,244] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6) with correlationId 4 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,244] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6) with correlationId 4 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,245] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,248] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6),ReplicationFactor:1),AllReplicas:0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 3 (state.change.logger)
[2015-08-10 12:28:09,249] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 3 (state.change.logger)
[2015-08-10 12:28:09,249] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 3 (state.change.logger)
[2015-08-10 12:28:09,249] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 3 (state.change.logger)
[2015-08-10 12:28:09,249] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 3 (state.change.logger)
[2015-08-10 12:28:09,257] TRACE Controller 0 epoch 7 elected leader 0 for Offline partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,259] TRACE Controller 0 epoch 7 changed partition [messages-replicated,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:28:09,259] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,261] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(3,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:28:09,266] TRACE Controller 0 epoch 7 elected leader 0 for Offline partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,267] TRACE Controller 0 epoch 7 changed partition [messages-replicated-part3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:28:09,267] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,275] TRACE Controller 0 epoch 7 elected leader 0 for Offline partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,276] TRACE Controller 0 epoch 7 changed partition [messages-replicated-part3,1] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:28:09,276] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,283] TRACE Controller 0 epoch 7 elected leader 0 for Offline partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,284] TRACE Controller 0 epoch 7 changed partition [messages-replicated-part3,2] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:28:09,284] TRACE Controller 0 epoch 7 started leader election for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,290] TRACE Controller 0 epoch 7 elected leader 0 for Offline partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,291] TRACE Controller 0 epoch 7 changed partition [messages,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:28:09,291] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7) with correlationId 5 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,292] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7) with correlationId 5 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,292] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 5 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,292] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7) with correlationId 5 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,292] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 5 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,292] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7) with correlationId 5 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,292] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7) with correlationId 5 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,292] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 5 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,293] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7) with correlationId 5 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,293] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 5 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,293] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6),ReplicationFactor:1),AllReplicas:0) correlation id 4 from controller 0 epoch 7 for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,293] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 4 from controller 0 epoch 7 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,294] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 4 from controller 0 epoch 7 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,294] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 4 from controller 0 epoch 7 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,294] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 4 from controller 0 epoch 7 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,300] TRACE Broker 0 handling LeaderAndIsr request correlationId 4 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,301] TRACE Broker 0 handling LeaderAndIsr request correlationId 4 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,301] TRACE Broker 0 handling LeaderAndIsr request correlationId 4 from controller 0 epoch 7 starting the become-follower transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,301] TRACE Broker 0 handling LeaderAndIsr request correlationId 4 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,301] TRACE Broker 0 handling LeaderAndIsr request correlationId 4 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,302] ERROR Broker 0 received LeaderAndIsrRequest with correlation id 4 from controller 0 epoch 6 for partition [messages-replicated-part3,0] but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2015-08-10 12:28:09,307] ERROR Broker 0 received LeaderAndIsrRequest with correlation id 4 from controller 0 epoch 6 for partition [messages-replicated-part3,1] but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2015-08-10 12:28:09,309] ERROR Broker 0 received LeaderAndIsrRequest with correlation id 4 from controller 0 epoch 6 for partition [messages,0] but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2015-08-10 12:28:09,312] ERROR Broker 0 received LeaderAndIsrRequest with correlation id 4 from controller 0 epoch 6 for partition [messages-replicated-part3,2] but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2015-08-10 12:28:09,315] ERROR Broker 0 received LeaderAndIsrRequest with correlation id 4 from controller 0 epoch 6 for partition [messages-replicated,0] but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2015-08-10 12:28:09,330] TRACE Broker 0 completed LeaderAndIsr request correlationId 4 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,330] TRACE Broker 0 completed LeaderAndIsr request correlationId 4 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,330] TRACE Broker 0 completed LeaderAndIsr request correlationId 4 from controller 0 epoch 7 for the become-follower transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,330] TRACE Broker 0 completed LeaderAndIsr request correlationId 4 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,330] TRACE Broker 0 completed LeaderAndIsr request correlationId 4 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,335] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(4,Map((messages-replicated-part3,0) -> 0, (messages-replicated,0) -> 0, (messages-replicated-part3,1) -> 0, (messages-replicated-part3,2) -> 0, (messages,0) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:28:09,337] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6),ReplicationFactor:1),AllReplicas:0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 4 (state.change.logger)
[2015-08-10 12:28:09,337] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 4 (state.change.logger)
[2015-08-10 12:28:09,337] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 4 (state.change.logger)
[2015-08-10 12:28:09,337] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 4 (state.change.logger)
[2015-08-10 12:28:09,337] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 4 (state.change.logger)
[2015-08-10 12:28:09,338] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(4,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:28:09,339] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:0) correlation id 5 from controller 0 epoch 7 for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,339] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 5 from controller 0 epoch 7 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,339] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 5 from controller 0 epoch 7 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,339] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 5 from controller 0 epoch 7 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,339] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 5 from controller 0 epoch 7 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,341] TRACE Broker 0 handling LeaderAndIsr request correlationId 5 from controller 0 epoch 7 starting the become-leader transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,341] TRACE Broker 0 handling LeaderAndIsr request correlationId 5 from controller 0 epoch 7 starting the become-leader transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,341] TRACE Broker 0 handling LeaderAndIsr request correlationId 5 from controller 0 epoch 7 starting the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,341] TRACE Broker 0 handling LeaderAndIsr request correlationId 5 from controller 0 epoch 7 starting the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,341] TRACE Broker 0 handling LeaderAndIsr request correlationId 5 from controller 0 epoch 7 starting the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,343] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 5 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,343] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 5 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,343] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 5 for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,343] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 5 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,343] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 5 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,354] TRACE Broker 0 completed LeaderAndIsr request correlationId 5 from controller 0 epoch 7 for the become-leader transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:28:09,355] TRACE Broker 0 completed LeaderAndIsr request correlationId 5 from controller 0 epoch 7 for the become-leader transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:28:09,355] TRACE Broker 0 completed LeaderAndIsr request correlationId 5 from controller 0 epoch 7 for the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:28:09,355] TRACE Broker 0 completed LeaderAndIsr request correlationId 5 from controller 0 epoch 7 for the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:28:09,355] TRACE Broker 0 completed LeaderAndIsr request correlationId 5 from controller 0 epoch 7 for the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:28:09,356] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(5,Map((messages-replicated-part3,0) -> 0, (messages-replicated,0) -> 0, (messages-replicated-part3,1) -> 0, (messages-replicated-part3,2) -> 0, (messages,0) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:28:09,358] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 5 (state.change.logger)
[2015-08-10 12:28:09,358] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 5 (state.change.logger)
[2015-08-10 12:28:09,358] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 5 (state.change.logger)
[2015-08-10 12:28:09,358] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 5 (state.change.logger)
[2015-08-10 12:28:09,358] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 5 (state.change.logger)
[2015-08-10 12:28:09,359] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(5,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:32:03,136] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7) with correlationId 6 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:32:03,136] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7) with correlationId 6 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:32:03,137] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 6 to broker 1 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:32:03,137] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7) with correlationId 6 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:32:03,137] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 6 to broker 1 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:32:03,138] TRACE Controller 0 epoch 7 changed state of replica 1 for partition [messages-replicated,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:32:03,138] TRACE Controller 0 epoch 7 changed state of replica 1 for partition [messages-replicated-part3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:32:03,139] TRACE Controller 0 epoch 7 changed state of replica 1 for partition [messages-replicated-part3,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:32:03,139] TRACE Controller 0 epoch 7 changed state of replica 1 for partition [messages-replicated-part3,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:32:03,139] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 7 to broker 1 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:32:03,139] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7) with correlationId 7 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:32:03,139] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 7 to broker 1 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:32:03,139] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7) with correlationId 7 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:32:03,139] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 7 to broker 1 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:32:03,140] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7) with correlationId 7 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:32:03,140] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 7 to broker 1 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:32:03,140] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7) with correlationId 7 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:32:03,140] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 7 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:32:03,140] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7) with correlationId 7 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:32:03,140] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7) with correlationId 7 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:32:03,140] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7) with correlationId 7 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:32:03,141] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 7 (state.change.logger)
[2015-08-10 12:32:03,141] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 7 (state.change.logger)
[2015-08-10 12:32:03,141] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 7 (state.change.logger)
[2015-08-10 12:32:03,141] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 7 (state.change.logger)
[2015-08-10 12:32:03,142] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(7,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:32:03,164] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 6 (state.change.logger)
[2015-08-10 12:32:03,164] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 6 (state.change.logger)
[2015-08-10 12:32:03,165] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 6 (state.change.logger)
[2015-08-10 12:32:03,165] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 6 (state.change.logger)
[2015-08-10 12:32:03,165] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 6 (state.change.logger)
[2015-08-10 12:32:03,175] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(6,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:32:03,235] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 7 from controller 0 epoch 7 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:32:03,235] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 7 from controller 0 epoch 7 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:32:03,235] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 7 from controller 0 epoch 7 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:32:03,235] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 7 from controller 0 epoch 7 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:32:03,242] TRACE Broker 1 handling LeaderAndIsr request correlationId 7 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:32:03,242] TRACE Broker 1 handling LeaderAndIsr request correlationId 7 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:32:03,242] TRACE Broker 1 handling LeaderAndIsr request correlationId 7 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:32:03,242] TRACE Broker 1 handling LeaderAndIsr request correlationId 7 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:32:03,268] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 7 with correlation id 7 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:32:03,268] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 7 with correlation id 7 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:32:03,268] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 7 with correlation id 7 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:32:03,268] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 7 with correlation id 7 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:32:03,277] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition [messages-replicated-part3,0] as part of become-follower request with correlation id 7 from controller 0 epoch 7 (state.change.logger)
[2015-08-10 12:32:03,277] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition [messages-replicated-part3,1] as part of become-follower request with correlation id 7 from controller 0 epoch 7 (state.change.logger)
[2015-08-10 12:32:03,277] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition [messages-replicated-part3,2] as part of become-follower request with correlation id 7 from controller 0 epoch 7 (state.change.logger)
[2015-08-10 12:32:03,278] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition [messages-replicated,0] as part of become-follower request with correlation id 7 from controller 0 epoch 7 (state.change.logger)
[2015-08-10 12:32:03,295] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 7 with correlation id 7 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:32:03,295] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 7 with correlation id 7 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:32:03,295] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 7 with correlation id 7 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:32:03,295] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 7 with correlation id 7 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:32:03,296] TRACE Broker 1 completed LeaderAndIsr request correlationId 7 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:32:03,297] TRACE Broker 1 completed LeaderAndIsr request correlationId 7 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:32:03,297] TRACE Broker 1 completed LeaderAndIsr request correlationId 7 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:32:03,297] TRACE Broker 1 completed LeaderAndIsr request correlationId 7 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:32:03,302] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(7,Map((messages-replicated-part3,0) -> 0, (messages-replicated,0) -> 0, (messages-replicated-part3,1) -> 0, (messages-replicated-part3,2) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:32:03,306] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 7 (state.change.logger)
[2015-08-10 12:32:03,306] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 7 (state.change.logger)
[2015-08-10 12:32:03,306] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 7 (state.change.logger)
[2015-08-10 12:32:03,307] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 7 (state.change.logger)
[2015-08-10 12:32:03,307] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(7,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:14,184] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,034] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2015-08-10 12:33:33,567] TRACE Controller 0 epoch 7 elected leader 1 for Offline partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,567] TRACE Controller 0 epoch 7 changed partition [messages-replicated,0] from OnlinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-10 12:33:33,567] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7) with correlationId 9 to broker 2 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,569] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7) with correlationId 9 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,569] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7) with correlationId 9 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,569] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7) with correlationId 9 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,569] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7) with correlationId 9 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,569] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 9 from controller 0 epoch 7 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,569] TRACE Broker 0 handling LeaderAndIsr request correlationId 9 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,569] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 9 from controller 0 epoch 7 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,570] TRACE Broker 1 handling LeaderAndIsr request correlationId 9 from controller 0 epoch 7 starting the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,573] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 9 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,573] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,576] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 7 with correlation id 9 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,579] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition [messages-replicated,0] as part of become-follower request with correlation id 9 from controller 0 epoch 7 (state.change.logger)
[2015-08-10 12:33:33,579] TRACE Controller 0 epoch 7 elected leader 1 for Offline partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,580] TRACE Controller 0 epoch 7 changed partition [messages-replicated-part3,2] from OnlinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-10 12:33:33,580] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:6,ControllerEpoch:7) with correlationId 10 to broker 2 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,580] TRACE Broker 0 skipped the adding-fetcher step of the become-follower state change with correlation id 9 from controller 0 epoch 7 for partition [messages-replicated,0] since it is shutting down (state.change.logger)
[2015-08-10 12:33:33,580] TRACE Broker 0 completed LeaderAndIsr request correlationId 9 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,580] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:6,ControllerEpoch:7) with correlationId 10 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,581] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:6,ControllerEpoch:7) with correlationId 10 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,581] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:0,1,LeaderEpoch:6,ControllerEpoch:7) with correlationId 10 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,581] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:0,1,LeaderEpoch:6,ControllerEpoch:7) with correlationId 10 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,581] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(9,Map((messages-replicated,0) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,582] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 9 (state.change.logger)
[2015-08-10 12:33:33,582] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(9,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,582] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 10 from controller 0 epoch 7 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,583] TRACE Broker 0 handling LeaderAndIsr request correlationId 10 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,583] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 7 with correlation id 10 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,584] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition [messages-replicated-part3,2] as part of become-follower request with correlation id 10 from controller 0 epoch 7 (state.change.logger)
[2015-08-10 12:33:33,584] TRACE Broker 0 skipped the adding-fetcher step of the become-follower state change with correlation id 10 from controller 0 epoch 7 for partition [messages-replicated-part3,2] since it is shutting down (state.change.logger)
[2015-08-10 12:33:33,584] TRACE Broker 0 completed LeaderAndIsr request correlationId 10 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,585] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(10,Map((messages-replicated-part3,2) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,585] TRACE Broker 1 completed LeaderAndIsr request correlationId 9 from controller 0 epoch 7 for the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,585] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 10 (state.change.logger)
[2015-08-10 12:33:33,585] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(9,Map((messages-replicated,0) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,585] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(10,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,586] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 9 (state.change.logger)
[2015-08-10 12:33:33,586] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(9,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,587] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 10 from controller 0 epoch 7 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,587] TRACE Broker 1 handling LeaderAndIsr request correlationId 10 from controller 0 epoch 7 starting the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,587] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 10 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,588] TRACE Broker 1 completed LeaderAndIsr request correlationId 10 from controller 0 epoch 7 for the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,588] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(10,Map((messages-replicated-part3,2) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,589] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 10 (state.change.logger)
[2015-08-10 12:33:33,589] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(10,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,595] TRACE Broker 0 handling stop replica (delete=false) for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,595] TRACE Broker 0 finished handling stop replica (delete=false) for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,600] TRACE Controller 0 epoch 7 received response StopReplicaResponse(11,Map([messages-replicated-part3,2] -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,601] TRACE Controller 0 epoch 7 changed state of replica 0 for partition [messages-replicated-part3,2] from OnlineReplica to OfflineReplica (state.change.logger)
[2015-08-10 12:33:33,601] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 12 to broker 2 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,602] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 12 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,602] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 12 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,602] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 12 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,602] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 12 (state.change.logger)
[2015-08-10 12:33:33,603] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 12 from controller 0 epoch 7 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,603] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(12,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,603] TRACE Broker 1 handling LeaderAndIsr request correlationId 12 from controller 0 epoch 7 starting the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,603] TRACE Broker 0 handling stop replica (delete=false) for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,603] TRACE Broker 0 finished handling stop replica (delete=false) for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,603] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 12 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,604] TRACE Controller 0 epoch 7 received response StopReplicaResponse(12,Map([messages-replicated-part3,2] -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,604] TRACE Broker 1 completed LeaderAndIsr request correlationId 12 from controller 0 epoch 7 for the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,604] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(12,Map((messages-replicated-part3,2) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,604] TRACE Broker 0 handling stop replica (delete=false) for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,604] TRACE Broker 0 finished handling stop replica (delete=false) for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,605] TRACE Controller 0 epoch 7 received response StopReplicaResponse(13,Map([messages-replicated,0] -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,605] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 12 (state.change.logger)
[2015-08-10 12:33:33,605] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(12,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,608] TRACE Controller 0 epoch 7 changed state of replica 0 for partition [messages-replicated,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2015-08-10 12:33:33,609] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7) with correlationId 14 to broker 2 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,609] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7) with correlationId 14 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,609] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7) with correlationId 14 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,609] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7) with correlationId 14 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,610] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 14 (state.change.logger)
[2015-08-10 12:33:33,610] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,610] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 14 from controller 0 epoch 7 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,610] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(14,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,610] TRACE Broker 1 handling LeaderAndIsr request correlationId 14 from controller 0 epoch 7 starting the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,610] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 14 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,610] TRACE Broker 0 handling stop replica (delete=false) for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,611] TRACE Broker 0 finished handling stop replica (delete=false) for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,610] TRACE Broker 1 completed LeaderAndIsr request correlationId 14 from controller 0 epoch 7 for the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,611] TRACE Controller 0 epoch 7 received response StopReplicaResponse(14,Map([messages-replicated,0] -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,611] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(14,Map((messages-replicated,0) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,612] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 14 (state.change.logger)
[2015-08-10 12:33:33,613] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(14,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,616] TRACE Controller 0 epoch 7 elected leader 1 for Offline partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,617] TRACE Controller 0 epoch 7 changed partition [messages-replicated-part3,1] from OnlinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-10 12:33:33,617] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 15 to broker 1 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,617] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 15 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,617] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 15 to broker 1 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,617] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 15 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,617] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,617] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 15 from controller 0 epoch 7 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,617] TRACE Broker 0 handling LeaderAndIsr request correlationId 15 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,617] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 15 from controller 0 epoch 7 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,618] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 7 with correlation id 15 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,618] TRACE Broker 1 handling LeaderAndIsr request correlationId 15 from controller 0 epoch 7 starting the become-leader transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,618] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 15 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,619] TRACE Broker 1 completed LeaderAndIsr request correlationId 15 from controller 0 epoch 7 for the become-leader transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,619] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition [messages-replicated-part3,1] as part of become-follower request with correlation id 15 from controller 0 epoch 7 (state.change.logger)
[2015-08-10 12:33:33,619] TRACE Broker 0 skipped the adding-fetcher step of the become-follower state change with correlation id 15 from controller 0 epoch 7 for partition [messages-replicated-part3,1] since it is shutting down (state.change.logger)
[2015-08-10 12:33:33,619] TRACE Broker 0 completed LeaderAndIsr request correlationId 15 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,619] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(15,Map((messages-replicated-part3,1) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,619] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(15,Map((messages-replicated-part3,1) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,620] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 15 (state.change.logger)
[2015-08-10 12:33:33,620] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 15 (state.change.logger)
[2015-08-10 12:33:33,620] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(15,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,620] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(15,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,622] TRACE Controller 0 epoch 7 elected leader 1 for Offline partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,623] TRACE Controller 0 epoch 7 changed partition [messages-replicated-part3,0] from OnlinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-10 12:33:33,623] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 16 to broker 1 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,623] TRACE Controller 0 epoch 7 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 16 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,623] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 16 to broker 1 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,624] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 16 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,624] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 16 from controller 0 epoch 7 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,624] TRACE Broker 0 handling LeaderAndIsr request correlationId 16 from controller 0 epoch 7 starting the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,624] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 16 from controller 0 epoch 7 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,624] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 7 with correlation id 16 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,624] TRACE Broker 1 handling LeaderAndIsr request correlationId 16 from controller 0 epoch 7 starting the become-leader transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,625] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 16 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,625] TRACE Broker 1 completed LeaderAndIsr request correlationId 16 from controller 0 epoch 7 for the become-leader transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,625] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition [messages-replicated-part3,0] as part of become-follower request with correlation id 16 from controller 0 epoch 7 (state.change.logger)
[2015-08-10 12:33:33,625] TRACE Broker 0 skipped the adding-fetcher step of the become-follower state change with correlation id 16 from controller 0 epoch 7 for partition [messages-replicated-part3,0] since it is shutting down (state.change.logger)
[2015-08-10 12:33:33,625] TRACE Broker 0 completed LeaderAndIsr request correlationId 16 from controller 0 epoch 7 for the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,626] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(16,Map((messages-replicated-part3,0) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,626] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 16 (state.change.logger)
[2015-08-10 12:33:33,628] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,629] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(16,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:33:33,633] ERROR Controller 0 epoch 7 encountered error while electing leader for partition [messages-replicated,0] due to: No other replicas in ISR 1 for [messages-replicated,0] besides shutting down brokers 0,1. (state.change.logger)
[2015-08-10 12:33:33,633] ERROR Controller 0 epoch 7 initiated state change for partition [messages-replicated,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated,0] due to: No other replicas in ISR 1 for [messages-replicated,0] besides shutting down brokers 0,1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated,0] besides shutting down brokers 0,1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:33:33,634] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,639] ERROR Controller 0 epoch 7 encountered error while electing leader for partition [messages-replicated-part3,0] due to: No other replicas in ISR 1 for [messages-replicated-part3,0] besides shutting down brokers 0,1. (state.change.logger)
[2015-08-10 12:33:33,639] ERROR Controller 0 epoch 7 initiated state change for partition [messages-replicated-part3,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated-part3,0] due to: No other replicas in ISR 1 for [messages-replicated-part3,0] besides shutting down brokers 0,1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated-part3,0] besides shutting down brokers 0,1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:33:33,640] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,646] ERROR Controller 0 epoch 7 encountered error while electing leader for partition [messages-replicated-part3,1] due to: No other replicas in ISR 1 for [messages-replicated-part3,1] besides shutting down brokers 0,1. (state.change.logger)
[2015-08-10 12:33:33,646] ERROR Controller 0 epoch 7 initiated state change for partition [messages-replicated-part3,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated-part3,1] due to: No other replicas in ISR 1 for [messages-replicated-part3,1] besides shutting down brokers 0,1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated-part3,1] besides shutting down brokers 0,1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:33:33,647] TRACE Controller 0 epoch 7 started leader election for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,652] TRACE Controller 0 epoch 7 received response LeaderAndIsrResponse(16,Map((messages-replicated-part3,0) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,654] ERROR Controller 0 epoch 7 encountered error while electing leader for partition [messages-replicated-part3,2] due to: No other replicas in ISR 1 for [messages-replicated-part3,2] besides shutting down brokers 0,1. (state.change.logger)
[2015-08-10 12:33:33,654] ERROR Controller 0 epoch 7 initiated state change for partition [messages-replicated-part3,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated-part3,2] due to: No other replicas in ISR 1 for [messages-replicated-part3,2] besides shutting down brokers 0,1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated-part3,2] besides shutting down brokers 0,1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:33:33,658] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 16 (state.change.logger)
[2015-08-10 12:33:33,659] TRACE Controller 0 epoch 7 received response UpdateMetadataResponse(16,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,884] TRACE Controller 1 epoch 8 changed state of replica 1 for partition [messages-replicated,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:33:33,884] TRACE Controller 1 epoch 8 changed state of replica 1 for partition [messages-replicated-part3,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:33:33,884] TRACE Controller 1 epoch 8 changed state of replica 1 for partition [messages-replicated-part3,1] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:33:33,885] TRACE Controller 1 epoch 8 changed state of replica 1 for partition [messages-replicated-part3,2] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:33:33,887] TRACE Controller 1 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 0 to broker 1 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,888] TRACE Controller 1 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7) with correlationId 0 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,888] TRACE Controller 1 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 0 to broker 1 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,888] TRACE Controller 1 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 0 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,889] TRACE Controller 1 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 0 to broker 1 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,889] TRACE Controller 1 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7) with correlationId 0 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,889] TRACE Controller 1 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 0 to broker 1 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,889] TRACE Controller 1 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 0 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,892] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 0 from controller 1 epoch 8 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,892] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 0 from controller 1 epoch 8 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,892] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 0 from controller 1 epoch 8 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,892] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 0 from controller 1 epoch 8 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,893] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 0 epoch 8 for partition [messages-replicated,0] since its associated leader epoch 14 is old. Current leader epoch is 14 (state.change.logger)
[2015-08-10 12:33:33,893] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 0 epoch 8 for partition [messages-replicated-part3,0] since its associated leader epoch 7 is old. Current leader epoch is 7 (state.change.logger)
[2015-08-10 12:33:33,893] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 0 epoch 8 for partition [messages-replicated-part3,1] since its associated leader epoch 7 is old. Current leader epoch is 7 (state.change.logger)
[2015-08-10 12:33:33,894] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 0 epoch 8 for partition [messages-replicated-part3,2] since its associated leader epoch 7 is old. Current leader epoch is 7 (state.change.logger)
[2015-08-10 12:33:33,895] TRACE Controller 1 epoch 8 started leader election for partition [messages,0] (state.change.logger)
[2015-08-10 12:33:33,897] TRACE Controller 1 epoch 8 received response LeaderAndIsrResponse(0,Map((messages-replicated,0) -> 13, (messages-replicated-part3,0) -> 13, (messages-replicated-part3,1) -> 13, (messages-replicated-part3,2) -> 13),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,900] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 1 epoch 8 with correlation id 0 (state.change.logger)
[2015-08-10 12:33:33,900] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 1 epoch 8 with correlation id 0 (state.change.logger)
[2015-08-10 12:33:33,901] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 1 epoch 8 with correlation id 0 (state.change.logger)
[2015-08-10 12:33:33,901] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 1 epoch 8 with correlation id 0 (state.change.logger)
[2015-08-10 12:33:33,901] TRACE Controller 1 epoch 8 received response UpdateMetadataResponse(0,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:33,905] ERROR Controller 1 epoch 8 initiated state change for partition [messages,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [messages,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 12:33:33,917] TRACE Controller 1 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7) with correlationId 3 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:33:33,918] TRACE Controller 1 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7) with correlationId 3 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:33,918] TRACE Controller 1 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 3 to broker 1 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:33,918] TRACE Controller 1 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 3 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:33,918] TRACE Controller 1 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 3 to broker 1 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:33,919] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:0) for partition [messages,0] in response to UpdateMetadata request sent by controller 1 epoch 8 with correlation id 3 (state.change.logger)
[2015-08-10 12:33:33,919] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 1 epoch 8 with correlation id 3 (state.change.logger)
[2015-08-10 12:33:33,919] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 1 epoch 8 with correlation id 3 (state.change.logger)
[2015-08-10 12:33:33,919] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 1 epoch 8 with correlation id 3 (state.change.logger)
[2015-08-10 12:33:33,920] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 1 epoch 8 with correlation id 3 (state.change.logger)
[2015-08-10 12:33:33,920] TRACE Controller 1 epoch 8 received response UpdateMetadataResponse(3,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:33:38,671] TRACE Controller 1 epoch 8 started leader election for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:38,677] ERROR Controller 1 epoch 8 encountered error while electing leader for partition [messages-replicated,0] due to: No other replicas in ISR 1 for [messages-replicated,0] besides shutting down brokers 1. (state.change.logger)
[2015-08-10 12:33:38,677] ERROR Controller 1 epoch 8 initiated state change for partition [messages-replicated,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated,0] due to: No other replicas in ISR 1 for [messages-replicated,0] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated,0] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:33:38,677] TRACE Controller 1 epoch 8 started leader election for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:38,681] ERROR Controller 1 epoch 8 encountered error while electing leader for partition [messages-replicated-part3,0] due to: No other replicas in ISR 1 for [messages-replicated-part3,0] besides shutting down brokers 1. (state.change.logger)
[2015-08-10 12:33:38,681] ERROR Controller 1 epoch 8 initiated state change for partition [messages-replicated-part3,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated-part3,0] due to: No other replicas in ISR 1 for [messages-replicated-part3,0] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated-part3,0] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:33:38,681] TRACE Controller 1 epoch 8 started leader election for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:38,684] ERROR Controller 1 epoch 8 encountered error while electing leader for partition [messages-replicated-part3,1] due to: No other replicas in ISR 1 for [messages-replicated-part3,1] besides shutting down brokers 1. (state.change.logger)
[2015-08-10 12:33:38,685] ERROR Controller 1 epoch 8 initiated state change for partition [messages-replicated-part3,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated-part3,1] due to: No other replicas in ISR 1 for [messages-replicated-part3,1] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated-part3,1] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:33:38,685] TRACE Controller 1 epoch 8 started leader election for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:38,690] ERROR Controller 1 epoch 8 encountered error while electing leader for partition [messages-replicated-part3,2] due to: No other replicas in ISR 1 for [messages-replicated-part3,2] besides shutting down brokers 1. (state.change.logger)
[2015-08-10 12:33:38,690] ERROR Controller 1 epoch 8 initiated state change for partition [messages-replicated-part3,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated-part3,2] due to: No other replicas in ISR 1 for [messages-replicated-part3,2] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated-part3,2] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:33:43,712] TRACE Controller 1 epoch 8 started leader election for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:33:43,717] ERROR Controller 1 epoch 8 encountered error while electing leader for partition [messages-replicated,0] due to: No other replicas in ISR 1 for [messages-replicated,0] besides shutting down brokers 1. (state.change.logger)
[2015-08-10 12:33:43,717] ERROR Controller 1 epoch 8 initiated state change for partition [messages-replicated,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated,0] due to: No other replicas in ISR 1 for [messages-replicated,0] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated,0] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:33:43,718] TRACE Controller 1 epoch 8 started leader election for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:33:43,721] ERROR Controller 1 epoch 8 encountered error while electing leader for partition [messages-replicated-part3,0] due to: No other replicas in ISR 1 for [messages-replicated-part3,0] besides shutting down brokers 1. (state.change.logger)
[2015-08-10 12:33:43,721] ERROR Controller 1 epoch 8 initiated state change for partition [messages-replicated-part3,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated-part3,0] due to: No other replicas in ISR 1 for [messages-replicated-part3,0] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated-part3,0] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:33:43,722] TRACE Controller 1 epoch 8 started leader election for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:33:43,725] ERROR Controller 1 epoch 8 encountered error while electing leader for partition [messages-replicated-part3,1] due to: No other replicas in ISR 1 for [messages-replicated-part3,1] besides shutting down brokers 1. (state.change.logger)
[2015-08-10 12:33:43,726] ERROR Controller 1 epoch 8 initiated state change for partition [messages-replicated-part3,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated-part3,1] due to: No other replicas in ISR 1 for [messages-replicated-part3,1] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated-part3,1] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:33:43,726] TRACE Controller 1 epoch 8 started leader election for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:33:43,729] ERROR Controller 1 epoch 8 encountered error while electing leader for partition [messages-replicated-part3,2] due to: No other replicas in ISR 1 for [messages-replicated-part3,2] besides shutting down brokers 1. (state.change.logger)
[2015-08-10 12:33:43,729] ERROR Controller 1 epoch 8 initiated state change for partition [messages-replicated-part3,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages-replicated-part3,2] due to: No other replicas in ISR 1 for [messages-replicated-part3,2] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set4.foreach(Set.scala:137)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages-replicated-part3,2] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:34:08,078] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2015-08-10 12:34:15,597] TRACE Controller 0 epoch 9 started leader election for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,611] ERROR Controller 0 epoch 9 initiated state change for partition [messages-replicated,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [messages-replicated,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 12:34:15,615] TRACE Controller 0 epoch 9 started leader election for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,625] ERROR Controller 0 epoch 9 initiated state change for partition [messages-replicated-part3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [messages-replicated-part3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 0, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 12:34:15,626] TRACE Controller 0 epoch 9 started leader election for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,634] ERROR Controller 0 epoch 9 initiated state change for partition [messages-replicated-part3,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [messages-replicated-part3,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 1, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 12:34:15,635] TRACE Controller 0 epoch 9 started leader election for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,643] ERROR Controller 0 epoch 9 initiated state change for partition [messages-replicated-part3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [messages-replicated-part3,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 12:34:15,644] TRACE Controller 0 epoch 9 started leader election for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,651] ERROR Controller 0 epoch 9 initiated state change for partition [messages,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [messages,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 12:34:15,717] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7) with correlationId 3 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,717] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7) with correlationId 3 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,718] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 3 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,718] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 3 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,718] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 3 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,727] TRACE Controller 0 epoch 9 changed state of replica 0 for partition [messages-replicated,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:34:15,728] TRACE Controller 0 epoch 9 changed state of replica 0 for partition [messages,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:34:15,728] TRACE Controller 0 epoch 9 changed state of replica 0 for partition [messages-replicated-part3,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:34:15,728] TRACE Controller 0 epoch 9 changed state of replica 0 for partition [messages-replicated-part3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:34:15,729] TRACE Controller 0 epoch 9 changed state of replica 0 for partition [messages-replicated-part3,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:34:15,731] TRACE Controller 0 epoch 9 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7) with correlationId 4 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,732] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7) with correlationId 4 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,732] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 4 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,732] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 4 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,732] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 4 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,732] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7) with correlationId 4 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,733] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7) with correlationId 4 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,733] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 4 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,733] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 4 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,733] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7) with correlationId 4 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,734] TRACE Controller 0 epoch 9 started leader election for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,741] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 3 (state.change.logger)
[2015-08-10 12:34:15,741] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 3 (state.change.logger)
[2015-08-10 12:34:15,741] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 3 (state.change.logger)
[2015-08-10 12:34:15,742] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 3 (state.change.logger)
[2015-08-10 12:34:15,742] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 3 (state.change.logger)
[2015-08-10 12:34:15,746] TRACE Controller 0 epoch 9 elected leader 0 for Offline partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,749] TRACE Controller 0 epoch 9 changed partition [messages-replicated,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:34:15,749] TRACE Controller 0 epoch 9 started leader election for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,756] TRACE Controller 0 epoch 9 received response UpdateMetadataResponse(3,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:34:15,758] TRACE Controller 0 epoch 9 elected leader 0 for Offline partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,760] TRACE Controller 0 epoch 9 changed partition [messages-replicated-part3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:34:15,760] TRACE Controller 0 epoch 9 started leader election for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,768] TRACE Controller 0 epoch 9 elected leader 0 for Offline partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,769] TRACE Controller 0 epoch 9 changed partition [messages-replicated-part3,1] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:34:15,769] TRACE Controller 0 epoch 9 started leader election for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,776] TRACE Controller 0 epoch 9 elected leader 0 for Offline partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,777] TRACE Controller 0 epoch 9 changed partition [messages-replicated-part3,2] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:34:15,777] TRACE Controller 0 epoch 9 started leader election for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,783] TRACE Controller 0 epoch 9 elected leader 0 for Offline partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,784] TRACE Controller 0 epoch 9 changed partition [messages,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:34:15,785] TRACE Controller 0 epoch 9 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:9) with correlationId 5 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,785] TRACE Controller 0 epoch 9 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9) with correlationId 5 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,785] TRACE Controller 0 epoch 9 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 5 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,785] TRACE Controller 0 epoch 9 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 5 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,786] TRACE Controller 0 epoch 9 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 5 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,786] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:9) with correlationId 5 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,786] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9) with correlationId 5 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,787] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 5 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,787] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 5 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,787] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 5 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,804] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:0) correlation id 4 from controller 0 epoch 9 for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,804] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 4 from controller 0 epoch 9 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,804] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 4 from controller 0 epoch 9 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,804] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 4 from controller 0 epoch 9 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,804] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 4 from controller 0 epoch 9 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,811] TRACE Broker 0 handling LeaderAndIsr request correlationId 4 from controller 0 epoch 9 starting the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,814] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 4 for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,843] TRACE Broker 0 completed LeaderAndIsr request correlationId 4 from controller 0 epoch 9 for the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,844] TRACE Broker 0 handling LeaderAndIsr request correlationId 4 from controller 0 epoch 9 starting the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,844] TRACE Broker 0 handling LeaderAndIsr request correlationId 4 from controller 0 epoch 9 starting the become-follower transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,844] TRACE Broker 0 handling LeaderAndIsr request correlationId 4 from controller 0 epoch 9 starting the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,844] TRACE Broker 0 handling LeaderAndIsr request correlationId 4 from controller 0 epoch 9 starting the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,846] ERROR Broker 0 received LeaderAndIsrRequest with correlation id 4 from controller 0 epoch 7 for partition [messages-replicated-part3,0] but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2015-08-10 12:34:15,850] ERROR Broker 0 received LeaderAndIsrRequest with correlation id 4 from controller 0 epoch 7 for partition [messages-replicated-part3,1] but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2015-08-10 12:34:15,854] ERROR Broker 0 received LeaderAndIsrRequest with correlation id 4 from controller 0 epoch 7 for partition [messages-replicated-part3,2] but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2015-08-10 12:34:15,858] ERROR Broker 0 received LeaderAndIsrRequest with correlation id 4 from controller 0 epoch 7 for partition [messages-replicated,0] but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2015-08-10 12:34:15,872] TRACE Broker 0 completed LeaderAndIsr request correlationId 4 from controller 0 epoch 9 for the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,872] TRACE Broker 0 completed LeaderAndIsr request correlationId 4 from controller 0 epoch 9 for the become-follower transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,872] TRACE Broker 0 completed LeaderAndIsr request correlationId 4 from controller 0 epoch 9 for the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,873] TRACE Broker 0 completed LeaderAndIsr request correlationId 4 from controller 0 epoch 9 for the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,876] TRACE Controller 0 epoch 9 received response LeaderAndIsrResponse(4,Map((messages-replicated-part3,0) -> 0, (messages-replicated,0) -> 0, (messages-replicated-part3,1) -> 0, (messages-replicated-part3,2) -> 0, (messages,0) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:34:15,878] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 4 (state.change.logger)
[2015-08-10 12:34:15,878] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 4 (state.change.logger)
[2015-08-10 12:34:15,878] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 4 (state.change.logger)
[2015-08-10 12:34:15,878] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 4 (state.change.logger)
[2015-08-10 12:34:15,878] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 4 (state.change.logger)
[2015-08-10 12:34:15,879] TRACE Controller 0 epoch 9 received response UpdateMetadataResponse(4,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:34:15,880] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:0) correlation id 5 from controller 0 epoch 9 for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,880] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 5 from controller 0 epoch 9 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,880] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 5 from controller 0 epoch 9 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,880] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 5 from controller 0 epoch 9 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,880] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 5 from controller 0 epoch 9 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,881] TRACE Broker 0 handling LeaderAndIsr request correlationId 5 from controller 0 epoch 9 starting the become-leader transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,881] TRACE Broker 0 handling LeaderAndIsr request correlationId 5 from controller 0 epoch 9 starting the become-leader transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,881] TRACE Broker 0 handling LeaderAndIsr request correlationId 5 from controller 0 epoch 9 starting the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,881] TRACE Broker 0 handling LeaderAndIsr request correlationId 5 from controller 0 epoch 9 starting the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,881] TRACE Broker 0 handling LeaderAndIsr request correlationId 5 from controller 0 epoch 9 starting the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,881] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 5 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,881] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 5 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,882] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 5 for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,882] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 5 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,882] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 5 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,884] TRACE Broker 0 completed LeaderAndIsr request correlationId 5 from controller 0 epoch 9 for the become-leader transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:15,884] TRACE Broker 0 completed LeaderAndIsr request correlationId 5 from controller 0 epoch 9 for the become-leader transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:15,884] TRACE Broker 0 completed LeaderAndIsr request correlationId 5 from controller 0 epoch 9 for the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:15,884] TRACE Broker 0 completed LeaderAndIsr request correlationId 5 from controller 0 epoch 9 for the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:15,884] TRACE Broker 0 completed LeaderAndIsr request correlationId 5 from controller 0 epoch 9 for the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:15,885] TRACE Controller 0 epoch 9 received response LeaderAndIsrResponse(5,Map((messages-replicated-part3,0) -> 0, (messages-replicated,0) -> 0, (messages-replicated-part3,1) -> 0, (messages-replicated-part3,2) -> 0, (messages,0) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:34:15,886] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 5 (state.change.logger)
[2015-08-10 12:34:15,887] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 5 (state.change.logger)
[2015-08-10 12:34:15,887] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 5 (state.change.logger)
[2015-08-10 12:34:15,887] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 5 (state.change.logger)
[2015-08-10 12:34:15,887] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 5 (state.change.logger)
[2015-08-10 12:34:15,888] TRACE Controller 0 epoch 9 received response UpdateMetadataResponse(5,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:34:20,471] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:9) with correlationId 6 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:34:20,471] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9) with correlationId 6 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,471] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 6 to broker 1 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:20,472] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 6 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,472] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 6 to broker 1 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:20,473] TRACE Controller 0 epoch 9 changed state of replica 1 for partition [messages-replicated,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:34:20,474] TRACE Controller 0 epoch 9 changed state of replica 1 for partition [messages-replicated-part3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:34:20,474] TRACE Controller 0 epoch 9 changed state of replica 1 for partition [messages-replicated-part3,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:34:20,474] TRACE Controller 0 epoch 9 changed state of replica 1 for partition [messages-replicated-part3,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 12:34:20,474] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 7 to broker 1 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:20,475] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9) with correlationId 7 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,475] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 7 to broker 1 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:20,475] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 7 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,475] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 7 to broker 1 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:20,475] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9) with correlationId 7 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,475] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 7 to broker 1 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:20,475] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 7 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,476] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 7 to broker 0 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:20,476] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9) with correlationId 7 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,476] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 7 to broker 0 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:20,476] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9) with correlationId 7 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,478] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-10 12:34:20,478] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-10 12:34:20,478] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-10 12:34:20,478] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-10 12:34:20,479] TRACE Controller 0 epoch 9 received response UpdateMetadataResponse(7,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:34:20,502] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 6 (state.change.logger)
[2015-08-10 12:34:20,503] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 6 (state.change.logger)
[2015-08-10 12:34:20,503] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 6 (state.change.logger)
[2015-08-10 12:34:20,504] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 6 (state.change.logger)
[2015-08-10 12:34:20,504] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 6 (state.change.logger)
[2015-08-10 12:34:20,515] TRACE Controller 0 epoch 9 received response UpdateMetadataResponse(6,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:34:20,577] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 7 from controller 0 epoch 9 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,578] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 7 from controller 0 epoch 9 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:20,578] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 7 from controller 0 epoch 9 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:20,578] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 7 from controller 0 epoch 9 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,585] TRACE Broker 1 handling LeaderAndIsr request correlationId 7 from controller 0 epoch 9 starting the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:20,585] TRACE Broker 1 handling LeaderAndIsr request correlationId 7 from controller 0 epoch 9 starting the become-follower transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:20,586] TRACE Broker 1 handling LeaderAndIsr request correlationId 7 from controller 0 epoch 9 starting the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,586] TRACE Broker 1 handling LeaderAndIsr request correlationId 7 from controller 0 epoch 9 starting the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,634] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 7 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:20,634] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 7 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:20,634] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 7 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,634] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 7 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,641] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition [messages-replicated-part3,0] as part of become-follower request with correlation id 7 from controller 0 epoch 9 (state.change.logger)
[2015-08-10 12:34:20,641] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition [messages-replicated-part3,1] as part of become-follower request with correlation id 7 from controller 0 epoch 9 (state.change.logger)
[2015-08-10 12:34:20,641] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition [messages-replicated-part3,2] as part of become-follower request with correlation id 7 from controller 0 epoch 9 (state.change.logger)
[2015-08-10 12:34:20,641] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition [messages-replicated,0] as part of become-follower request with correlation id 7 from controller 0 epoch 9 (state.change.logger)
[2015-08-10 12:34:20,659] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 7 for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:20,659] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 7 for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:20,659] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 7 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,660] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 7 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,660] TRACE Broker 1 completed LeaderAndIsr request correlationId 7 from controller 0 epoch 9 for the become-follower transition for partition [messages-replicated-part3,0] (state.change.logger)
[2015-08-10 12:34:20,660] TRACE Broker 1 completed LeaderAndIsr request correlationId 7 from controller 0 epoch 9 for the become-follower transition for partition [messages-replicated-part3,1] (state.change.logger)
[2015-08-10 12:34:20,661] TRACE Broker 1 completed LeaderAndIsr request correlationId 7 from controller 0 epoch 9 for the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,661] TRACE Broker 1 completed LeaderAndIsr request correlationId 7 from controller 0 epoch 9 for the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,664] TRACE Controller 0 epoch 9 received response LeaderAndIsrResponse(7,Map((messages-replicated-part3,0) -> 0, (messages-replicated,0) -> 0, (messages-replicated-part3,1) -> 0, (messages-replicated-part3,2) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:34:20,665] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-10 12:34:20,666] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:2,0,1) for partition [messages-replicated-part3,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-10 12:34:20,666] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition [messages-replicated-part3,1] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-10 12:34:20,666] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-10 12:34:20,666] TRACE Controller 0 epoch 9 received response UpdateMetadataResponse(7,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:34:20,680] TRACE Controller 0 epoch 9 started leader election for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,687] TRACE Controller 0 epoch 9 elected leader 1 for Offline partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,688] TRACE Controller 0 epoch 9 changed partition [messages-replicated,0] from OnlinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-10 12:34:20,688] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9) with correlationId 9 to broker 2 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,689] TRACE Controller 0 epoch 9 sending become-leader LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9) with correlationId 9 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,689] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9) with correlationId 9 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,689] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9) with correlationId 9 to broker 1 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,689] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9) with correlationId 9 to broker 0 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,690] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 9 from controller 0 epoch 9 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,690] TRACE Broker 0 handling LeaderAndIsr request correlationId 9 from controller 0 epoch 9 starting the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,690] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 9 from controller 0 epoch 9 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,691] TRACE Controller 0 epoch 9 started leader election for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,691] TRACE Broker 1 handling LeaderAndIsr request correlationId 9 from controller 0 epoch 9 starting the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,693] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 9 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,693] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 9 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,695] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition [messages-replicated,0] as part of become-follower request with correlation id 9 from controller 0 epoch 9 (state.change.logger)
[2015-08-10 12:34:20,696] TRACE Controller 0 epoch 9 elected leader 1 for Offline partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,697] TRACE Controller 0 epoch 9 changed partition [messages-replicated-part3,2] from OnlinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-10 12:34:20,697] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:9,ControllerEpoch:9) with correlationId 10 to broker 2 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,697] TRACE Controller 0 epoch 9 sending become-leader LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:9,ControllerEpoch:9) with correlationId 10 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,697] TRACE Controller 0 epoch 9 sending become-follower LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:9,ControllerEpoch:9) with correlationId 10 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,697] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:0,1,LeaderEpoch:9,ControllerEpoch:9) with correlationId 10 to broker 1 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,698] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:1,ISR:0,1,LeaderEpoch:9,ControllerEpoch:9) with correlationId 10 to broker 0 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,703] TRACE Broker 1 completed LeaderAndIsr request correlationId 9 from controller 0 epoch 9 for the become-leader transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,704] TRACE Controller 0 epoch 9 received response LeaderAndIsrResponse(9,Map((messages-replicated,0) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:34:20,705] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 9 (state.change.logger)
[2015-08-10 12:34:20,705] TRACE Controller 0 epoch 9 received response UpdateMetadataResponse(9,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:34:20,706] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 10 from controller 0 epoch 9 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,706] TRACE Broker 1 handling LeaderAndIsr request correlationId 10 from controller 0 epoch 9 starting the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,707] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 10 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,707] TRACE Broker 1 completed LeaderAndIsr request correlationId 10 from controller 0 epoch 9 for the become-leader transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,708] TRACE Controller 0 epoch 9 received response LeaderAndIsrResponse(10,Map((messages-replicated-part3,2) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:34:20,708] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 10 (state.change.logger)
[2015-08-10 12:34:20,709] TRACE Controller 0 epoch 9 received response UpdateMetadataResponse(10,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:34:20,710] TRACE Broker 0 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 9 for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,710] TRACE Broker 0 completed LeaderAndIsr request correlationId 9 from controller 0 epoch 9 for the become-follower transition for partition [messages-replicated,0] (state.change.logger)
[2015-08-10 12:34:20,711] TRACE Controller 0 epoch 9 received response LeaderAndIsrResponse(9,Map((messages-replicated,0) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:34:20,712] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated,0] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 9 (state.change.logger)
[2015-08-10 12:34:20,712] TRACE Controller 0 epoch 9 received response UpdateMetadataResponse(9,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:34:20,712] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 10 from controller 0 epoch 9 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,713] TRACE Broker 0 handling LeaderAndIsr request correlationId 10 from controller 0 epoch 9 starting the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,713] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 10 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,714] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition [messages-replicated-part3,2] as part of become-follower request with correlation id 10 from controller 0 epoch 9 (state.change.logger)
[2015-08-10 12:34:20,714] TRACE Broker 0 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 10 for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,714] TRACE Broker 0 completed LeaderAndIsr request correlationId 10 from controller 0 epoch 9 for the become-follower transition for partition [messages-replicated-part3,2] (state.change.logger)
[2015-08-10 12:34:20,715] TRACE Controller 0 epoch 9 received response LeaderAndIsrResponse(10,Map((messages-replicated-part3,2) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:34:20,716] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) for partition [messages-replicated-part3,2] in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 10 (state.change.logger)
[2015-08-10 12:34:20,716] TRACE Controller 0 epoch 9 received response UpdateMetadataResponse(10,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:35:59,985] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2015-08-10 12:36:38,537] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2015-08-10 12:37:45,085] TRACE Controller 0 epoch 1 changed partition [messages,0] state from NonExistentPartition to NewPartition with assigned replicas 1,0 (state.change.logger)
[2015-08-10 12:37:45,093] TRACE Controller 0 epoch 1 changed state of replica 1 for partition [messages,0] from NonExistentReplica to NewReplica (state.change.logger)
[2015-08-10 12:37:45,094] TRACE Controller 0 epoch 1 changed state of replica 0 for partition [messages,0] from NonExistentReplica to NewReplica (state.change.logger)
[2015-08-10 12:37:45,116] TRACE Controller 0 epoch 1 changed partition [messages,0] from NewPartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-10 12:37:45,122] TRACE Controller 0 epoch 1 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,122] TRACE Controller 0 epoch 1 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,127] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,127] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,133] TRACE Controller 0 epoch 1 changed state of replica 1 for partition [messages,0] from NewReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:37:45,134] TRACE Controller 0 epoch 1 changed state of replica 0 for partition [messages,0] from NewReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:37:45,151] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) correlation id 9 from controller 0 epoch 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,156] TRACE Broker 0 handling LeaderAndIsr request correlationId 9 from controller 0 epoch 1 starting the become-follower transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,164] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) correlation id 9 from controller 0 epoch 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,174] TRACE Broker 1 handling LeaderAndIsr request correlationId 9 from controller 0 epoch 1 starting the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,188] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 1 with correlation id 9 for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,213] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 1 with correlation id 9 for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,220] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition [messages,0] as part of become-follower request with correlation id 9 from controller 0 epoch 1 (state.change.logger)
[2015-08-10 12:37:45,246] TRACE Broker 0 started fetcher to new leader as part of become-follower request from controller 0 epoch 1 with correlation id 9 for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,247] TRACE Broker 0 completed LeaderAndIsr request correlationId 9 from controller 0 epoch 1 for the become-follower transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,252] TRACE Broker 1 completed LeaderAndIsr request correlationId 9 from controller 0 epoch 1 for the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:37:45,256] TRACE Controller 0 epoch 1 received response LeaderAndIsrResponse(9,Map((messages,0) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:37:45,261] TRACE Controller 0 epoch 1 received response LeaderAndIsrResponse(9,Map((messages,0) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:37:45,298] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 9 (state.change.logger)
[2015-08-10 12:37:45,299] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(9,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:37:45,311] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 9 (state.change.logger)
[2015-08-10 12:37:45,313] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(9,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:50:50,088] TRACE Controller 0 epoch 1 started leader election for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,102] TRACE Controller 0 epoch 1 elected leader 0 for Offline partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,103] TRACE Controller 0 epoch 1 changed partition [messages,0] from OnlinePartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:50:50,103] TRACE Controller 0 epoch 1 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1) with correlationId 11 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,104] TRACE Controller 0 epoch 1 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1) with correlationId 11 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,104] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1) with correlationId 11 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,104] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1) with correlationId 11 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,400] TRACE Controller 0 epoch 1 changed state of replica 1 for partition [messages,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2015-08-10 12:50:50,401] TRACE Controller 0 epoch 1 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1) with correlationId 14 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,401] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1) with correlationId 14 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,414] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) correlation id 11 from controller 0 epoch 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,415] TRACE Broker 0 handling LeaderAndIsr request correlationId 11 from controller 0 epoch 1 starting the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,417] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 1 with correlation id 11 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,429] TRACE Broker 0 completed LeaderAndIsr request correlationId 11 from controller 0 epoch 1 for the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,619] TRACE Controller 0 epoch 1 received response LeaderAndIsrResponse(11,Map((messages,0) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:50:50,620] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 11 (state.change.logger)
[2015-08-10 12:50:50,620] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(11,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:50:50,620] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) correlation id 14 from controller 0 epoch 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:50,622] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 14 epoch 1 for partition [messages,0] since its associated leader epoch 1 is old. Current leader epoch is 1 (state.change.logger)
[2015-08-10 12:50:50,623] TRACE Controller 0 epoch 1 received response LeaderAndIsrResponse(14,Map((messages,0) -> 13),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:50:50,624] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 14 (state.change.logger)
[2015-08-10 12:50:50,625] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(14,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:50:52,997] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1) with correlationId 15 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:52,998] TRACE Controller 0 epoch 1 changed state of replica 1 for partition [messages,0] from OfflineReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:50:52,998] TRACE Controller 0 epoch 1 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1) with correlationId 16 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:52,999] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1) with correlationId 16 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:52,999] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1) with correlationId 16 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:53,000] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 16 (state.change.logger)
[2015-08-10 12:50:53,001] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(16,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:50:53,025] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 15 (state.change.logger)
[2015-08-10 12:50:53,035] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(15,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:50:53,086] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) correlation id 16 from controller 0 epoch 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:53,091] TRACE Broker 1 handling LeaderAndIsr request correlationId 16 from controller 0 epoch 1 starting the become-follower transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:53,103] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 1 with correlation id 16 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:53,108] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition [messages,0] as part of become-follower request with correlation id 16 from controller 0 epoch 1 (state.change.logger)
[2015-08-10 12:50:53,126] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 1 with correlation id 16 for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:53,126] TRACE Broker 1 completed LeaderAndIsr request correlationId 16 from controller 0 epoch 1 for the become-follower transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:50:53,132] TRACE Controller 0 epoch 1 received response LeaderAndIsrResponse(16,Map((messages,0) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:50:53,133] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 16 (state.change.logger)
[2015-08-10 12:50:53,134] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(16,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:51:46,669] TRACE Controller 0 epoch 1 started leader election for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,677] TRACE Controller 0 epoch 1 elected leader 1 for Offline partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,678] TRACE Controller 0 epoch 1 changed partition [messages,0] from OnlinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-10 12:51:46,678] TRACE Controller 0 epoch 1 sending become-leader LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:2,ControllerEpoch:1) with correlationId 18 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,678] TRACE Controller 0 epoch 1 sending become-follower LeaderAndIsr request (Leader:1,ISR:0,1,LeaderEpoch:2,ControllerEpoch:1) with correlationId 18 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,678] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:1,ISR:0,1,LeaderEpoch:2,ControllerEpoch:1) with correlationId 18 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,678] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:1,ISR:0,1,LeaderEpoch:2,ControllerEpoch:1) with correlationId 18 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,679] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:2,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) correlation id 18 from controller 0 epoch 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,679] TRACE Broker 0 handling LeaderAndIsr request correlationId 18 from controller 0 epoch 1 starting the become-follower transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,679] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 1 with correlation id 18 for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,679] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:2,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) correlation id 18 from controller 0 epoch 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,681] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition [messages,0] as part of become-follower request with correlation id 18 from controller 0 epoch 1 (state.change.logger)
[2015-08-10 12:51:46,681] TRACE Broker 1 handling LeaderAndIsr request correlationId 18 from controller 0 epoch 1 starting the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,683] TRACE Broker 0 started fetcher to new leader as part of become-follower request from controller 0 epoch 1 with correlation id 18 for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,683] TRACE Broker 0 completed LeaderAndIsr request correlationId 18 from controller 0 epoch 1 for the become-follower transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,685] TRACE Controller 0 epoch 1 received response LeaderAndIsrResponse(18,Map((messages,0) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:51:46,685] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 1 with correlation id 18 for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:46,686] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:2,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 18 (state.change.logger)
[2015-08-10 12:51:46,686] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(18,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:51:46,700] TRACE Broker 1 completed LeaderAndIsr request correlationId 18 from controller 0 epoch 1 for the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:51:47,027] TRACE Controller 0 epoch 1 received response LeaderAndIsrResponse(18,Map((messages,0) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:51:47,029] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:2,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 18 (state.change.logger)
[2015-08-10 12:51:47,029] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(18,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:57:48,404] TRACE Broker 0 handling stop replica (delete=false) for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:48,404] TRACE Broker 0 finished handling stop replica (delete=false) for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:48,407] TRACE Controller 0 epoch 1 received response StopReplicaResponse(19,Map([messages,0] -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:57:48,409] TRACE Controller 0 epoch 1 changed state of replica 0 for partition [messages,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2015-08-10 12:57:48,409] TRACE Controller 0 epoch 1 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1) with correlationId 20 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:48,409] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1) with correlationId 20 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:48,409] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1) with correlationId 20 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:48,410] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 20 (state.change.logger)
[2015-08-10 12:57:48,410] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(20,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:57:48,410] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) correlation id 20 from controller 0 epoch 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:48,411] TRACE Broker 1 handling LeaderAndIsr request correlationId 20 from controller 0 epoch 1 starting the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:48,411] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 1 with correlation id 20 for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:48,411] TRACE Broker 1 completed LeaderAndIsr request correlationId 20 from controller 0 epoch 1 for the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:48,412] TRACE Controller 0 epoch 1 received response LeaderAndIsrResponse(20,Map((messages,0) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:57:48,413] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 20 (state.change.logger)
[2015-08-10 12:57:48,413] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(20,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:57:48,886] TRACE Broker 0 handling stop replica (delete=false) for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:48,886] TRACE Broker 0 finished handling stop replica (delete=false) for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:49,126] TRACE Controller 1 epoch 2 changed state of replica 1 for partition [messages,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:57:49,128] TRACE Controller 1 epoch 2 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1) with correlationId 0 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:49,129] TRACE Controller 1 epoch 2 sending UpdateMetadata request (Leader:-2,ISR:1,LeaderEpoch:0,ControllerEpoch:1) with correlationId 0 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:49,132] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) correlation id 0 from controller 1 epoch 2 for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:49,133] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 0 epoch 2 for partition [messages,0] since its associated leader epoch 3 is old. Current leader epoch is 3 (state.change.logger)
[2015-08-10 12:57:49,135] TRACE Controller 1 epoch 2 received response LeaderAndIsrResponse(0,Map((messages,0) -> 13),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:57:49,139] TRACE Broker 1 deleted partition [messages,0] from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 0 (state.change.logger)
[2015-08-10 12:57:49,140] TRACE Controller 1 epoch 2 received response UpdateMetadataResponse(0,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:57:49,145] TRACE Controller 1 epoch 2 sending UpdateMetadata request (Leader:-2,ISR:1,LeaderEpoch:0,ControllerEpoch:1) with correlationId 3 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:49,145] TRACE Broker 1 deleted partition [messages,0] from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 3 (state.change.logger)
[2015-08-10 12:57:49,146] TRACE Controller 1 epoch 2 received response UpdateMetadataResponse(3,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:57:52,042] TRACE Controller 1 epoch 2 started leader election for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:52,049] ERROR Controller 1 epoch 2 encountered error while electing leader for partition [messages,0] due to: No other replicas in ISR 1 for [messages,0] besides shutting down brokers 1. (state.change.logger)
[2015-08-10 12:57:52,050] ERROR Controller 1 epoch 2 initiated state change for partition [messages,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages,0] due to: No other replicas in ISR 1 for [messages,0] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages,0] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:57:57,071] TRACE Controller 1 epoch 2 started leader election for partition [messages,0] (state.change.logger)
[2015-08-10 12:57:57,077] ERROR Controller 1 epoch 2 encountered error while electing leader for partition [messages,0] due to: No other replicas in ISR 1 for [messages,0] besides shutting down brokers 1. (state.change.logger)
[2015-08-10 12:57:57,077] ERROR Controller 1 epoch 2 initiated state change for partition [messages,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages,0] due to: No other replicas in ISR 1 for [messages,0] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages,0] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:58:02,090] TRACE Controller 1 epoch 2 started leader election for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:02,097] ERROR Controller 1 epoch 2 encountered error while electing leader for partition [messages,0] due to: No other replicas in ISR 1 for [messages,0] besides shutting down brokers 1. (state.change.logger)
[2015-08-10 12:58:02,097] ERROR Controller 1 epoch 2 initiated state change for partition [messages,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [messages,0] due to: No other replicas in ISR 1 for [messages,0] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:380)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:208)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:258)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:253)
	at scala.Option.foreach(Option.scala:236)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:253)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:252)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:249)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:74)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:249)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:154)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:66)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:59)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [messages,0] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	... 20 more
[2015-08-10 12:58:23,221] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2015-08-10 12:58:36,984] TRACE Controller 0 epoch 1 changed partition [messages,1] state from NonExistentPartition to NewPartition with assigned replicas 1,0 (state.change.logger)
[2015-08-10 12:58:36,990] TRACE Controller 0 epoch 1 changed partition [messages,0] state from NonExistentPartition to NewPartition with assigned replicas 0,1 (state.change.logger)
[2015-08-10 12:58:36,996] TRACE Controller 0 epoch 1 changed state of replica 1 for partition [messages,1] from NonExistentReplica to NewReplica (state.change.logger)
[2015-08-10 12:58:36,997] TRACE Controller 0 epoch 1 changed state of replica 0 for partition [messages,1] from NonExistentReplica to NewReplica (state.change.logger)
[2015-08-10 12:58:36,999] TRACE Controller 0 epoch 1 changed state of replica 0 for partition [messages,0] from NonExistentReplica to NewReplica (state.change.logger)
[2015-08-10 12:58:37,000] TRACE Controller 0 epoch 1 changed state of replica 1 for partition [messages,0] from NonExistentReplica to NewReplica (state.change.logger)
[2015-08-10 12:58:37,015] TRACE Controller 0 epoch 1 changed partition [messages,1] from NewPartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-10 12:58:37,020] TRACE Controller 0 epoch 1 changed partition [messages,0] from NewPartition to OnlinePartition with leader 0 (state.change.logger)
[2015-08-10 12:58:37,026] TRACE Controller 0 epoch 1 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 1 for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,026] TRACE Controller 0 epoch 1 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,1,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,027] TRACE Controller 0 epoch 1 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 0 for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,027] TRACE Controller 0 epoch 1 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,1,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,031] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 1 for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,032] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:0,ISR:0,1,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,032] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 0 for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,033] TRACE Controller 0 epoch 1 sending UpdateMetadata request (Leader:0,ISR:0,1,LeaderEpoch:0,ControllerEpoch:1) with correlationId 9 to broker 0 for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,037] TRACE Controller 0 epoch 1 changed state of replica 1 for partition [messages,1] from NewReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:58:37,038] TRACE Controller 0 epoch 1 changed state of replica 0 for partition [messages,1] from NewReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:58:37,038] TRACE Controller 0 epoch 1 changed state of replica 0 for partition [messages,0] from NewReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:58:37,039] TRACE Controller 0 epoch 1 changed state of replica 1 for partition [messages,0] from NewReplica to OnlineReplica (state.change.logger)
[2015-08-10 12:58:37,056] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) correlation id 9 from controller 0 epoch 1 for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,057] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,1,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:0,1) correlation id 9 from controller 0 epoch 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,064] TRACE Broker 0 handling LeaderAndIsr request correlationId 9 from controller 0 epoch 1 starting the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,072] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) correlation id 9 from controller 0 epoch 1 for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,072] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,1,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:0,1) correlation id 9 from controller 0 epoch 1 for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,074] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 1 with correlation id 9 for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,081] TRACE Broker 1 handling LeaderAndIsr request correlationId 9 from controller 0 epoch 1 starting the become-leader transition for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,096] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 1 with correlation id 9 for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,112] TRACE Broker 0 completed LeaderAndIsr request correlationId 9 from controller 0 epoch 1 for the become-leader transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,113] TRACE Broker 0 handling LeaderAndIsr request correlationId 9 from controller 0 epoch 1 starting the become-follower transition for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,124] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 1 with correlation id 9 for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,130] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition [messages,1] as part of become-follower request with correlation id 9 from controller 0 epoch 1 (state.change.logger)
[2015-08-10 12:58:37,150] TRACE Broker 0 started fetcher to new leader as part of become-follower request from controller 0 epoch 1 with correlation id 9 for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,151] TRACE Broker 0 completed LeaderAndIsr request correlationId 9 from controller 0 epoch 1 for the become-follower transition for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,158] TRACE Broker 1 completed LeaderAndIsr request correlationId 9 from controller 0 epoch 1 for the become-leader transition for partition [messages,1] (state.change.logger)
[2015-08-10 12:58:37,159] TRACE Broker 1 handling LeaderAndIsr request correlationId 9 from controller 0 epoch 1 starting the become-follower transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,166] TRACE Controller 0 epoch 1 received response LeaderAndIsrResponse(9,Map((messages,1) -> 0, (messages,0) -> 0),0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:58:37,175] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 1 with correlation id 9 for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,182] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition [messages,0] as part of become-follower request with correlation id 9 from controller 0 epoch 1 (state.change.logger)
[2015-08-10 12:58:37,211] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,1] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 9 (state.change.logger)
[2015-08-10 12:58:37,211] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,1,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:0,1) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 9 (state.change.logger)
[2015-08-10 12:58:37,213] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(9,0) for a request sent to broker id:0,host:localhost.localdomain,port:9092 (state.change.logger)
[2015-08-10 12:58:37,213] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 1 with correlation id 9 for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,215] TRACE Broker 1 completed LeaderAndIsr request correlationId 9 from controller 0 epoch 1 for the become-follower transition for partition [messages,0] (state.change.logger)
[2015-08-10 12:58:37,222] TRACE Controller 0 epoch 1 received response LeaderAndIsrResponse(9,Map((messages,1) -> 0, (messages,0) -> 0),0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
[2015-08-10 12:58:37,267] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) for partition [messages,1] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 9 (state.change.logger)
[2015-08-10 12:58:37,267] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,1,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:0,1) for partition [messages,0] in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 9 (state.change.logger)
[2015-08-10 12:58:37,268] TRACE Controller 0 epoch 1 received response UpdateMetadataResponse(9,0) for a request sent to broker id:1,host:localhost.localdomain,port:9093 (state.change.logger)
