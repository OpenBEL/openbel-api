[2015-08-10 12:01:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:01:27,534] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 12:01:27,534] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:01:27,534] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:01:27,534] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:01:27,534] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:01:27,534] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:01:27,534] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:06:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:06:27,531] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 12:06:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:06:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:06:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:06:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:06:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:06:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:11:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:11:27,531] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 12:11:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:11:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:11:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:11:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:11:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:11:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:16:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:16:27,531] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 12:16:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:16:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:16:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:16:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:16:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:16:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:21:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:21:27,531] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 12:21:27,531] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:21:27,531] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:21:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:21:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:21:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:21:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:26:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:26:27,531] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 12:26:27,531] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:26:27,531] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:26:27,531] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:26:27,531] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:26:27,531] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:26:27,531] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:27:38,325] INFO [Controller 2]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-08-10 12:27:38,326] DEBUG [Controller 2]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-08-10 12:27:38,326] DEBUG [Controller 2]: Live brokers: 1,2 (kafka.controller.KafkaController)
[2015-08-10 12:27:38,326] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,327] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,327] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:27:38,327] DEBUG [Controller 2]: Removing replica 0 from ISR 1,2 for partition [messages-replicated-part3,2]. (kafka.controller.KafkaController)
[2015-08-10 12:27:38,327] WARN [Controller-2-to-broker-0-send-thread], Controller 2 epoch 6 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 23; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,2] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at sun.nio.ch.IOUtil.write(IOUtil.java:148)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:504)
	at java.nio.channels.SocketChannel.write(SocketChannel.java:502)
	at kafka.network.BoundedByteBufferSend.writeTo(BoundedByteBufferSend.scala:56)
	at kafka.network.Send$class.writeCompletely(Transmission.scala:75)
	at kafka.network.BoundedByteBufferSend.writeCompletely(BoundedByteBufferSend.scala:26)
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:103)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:27:38,328] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:27:38,332] INFO [Controller 2]: New leader and ISR for partition [messages-replicated-part3,2] is {"leader":1,"leader_epoch":3,"isr":[1,2]} (kafka.controller.KafkaController)
[2015-08-10 12:27:38,333] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,333] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,333] WARN [Controller-2-to-broker-2-send-thread], Controller 2 epoch 6 fails to send request Name:LeaderAndIsrRequest;Version:0;Controller:2;ControllerEpoch:6;CorrelationId:24;ClientId:id_2-host_null-port_9094;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated-part3,2) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:3,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) to broker id:2,host:localhost.localdomain,port:9094. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at sun.nio.ch.IOUtil.write(IOUtil.java:148)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:504)
	at java.nio.channels.SocketChannel.write(SocketChannel.java:502)
	at kafka.network.BoundedByteBufferSend.writeTo(BoundedByteBufferSend.scala:56)
	at kafka.network.Send$class.writeCompletely(Transmission.scala:75)
	at kafka.network.BoundedByteBufferSend.writeCompletely(BoundedByteBufferSend.scala:26)
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:103)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:27:38,333] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,333] WARN [Controller-2-to-broker-1-send-thread], Controller 2 epoch 6 fails to send request Name:LeaderAndIsrRequest;Version:0;Controller:2;ControllerEpoch:6;CorrelationId:24;ClientId:id_2-host_null-port_9094;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated-part3,2) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:3,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) to broker id:1,host:localhost.localdomain,port:9093. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at sun.nio.ch.IOUtil.write(IOUtil.java:148)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:504)
	at java.nio.channels.SocketChannel.write(SocketChannel.java:502)
	at kafka.network.BoundedByteBufferSend.writeTo(BoundedByteBufferSend.scala:56)
	at kafka.network.Send$class.writeCompletely(Transmission.scala:75)
	at kafka.network.BoundedByteBufferSend.writeCompletely(BoundedByteBufferSend.scala:26)
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:103)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:27:38,334] INFO [Controller-2-to-broker-2-send-thread], Controller 2 connected to id:2,host:localhost.localdomain,port:9094 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:27:38,333] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,335] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:27:38,335] INFO [Controller-2-to-broker-1-send-thread], Controller 2 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:27:38,335] DEBUG [Controller 2]: Removing replica 0 from ISR 2,1 for partition [messages-replicated,0]. (kafka.controller.KafkaController)
[2015-08-10 12:27:38,339] INFO [Controller 2]: New leader and ISR for partition [messages-replicated,0] is {"leader":1,"leader_epoch":10,"isr":[2,1]} (kafka.controller.KafkaController)
[2015-08-10 12:27:38,340] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,340] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,340] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,1] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:38,345] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages-replicated-part3,1] : current leader = 0, new leader = 1 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 12:27:38,347] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:2,1,LeaderEpoch:10,ControllerEpoch:6), [messages-replicated-part3,0] -> (Leader:2,ISR:2,1,LeaderEpoch:3,ControllerEpoch:6), [messages-replicated-part3,1] -> (Leader:1,ISR:1,2,LeaderEpoch:4,ControllerEpoch:6), [messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:3,ControllerEpoch:6), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:38,347] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,347] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,347] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated-part3,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:27:38,348] DEBUG [Controller 2]: Removing replica 0 from ISR 2,1 for partition [messages-replicated-part3,0]. (kafka.controller.KafkaController)
[2015-08-10 12:27:38,351] INFO [Controller 2]: New leader and ISR for partition [messages-replicated-part3,0] is {"leader":2,"leader_epoch":4,"isr":[2,1]} (kafka.controller.KafkaController)
[2015-08-10 12:27:38,351] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,351] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:38,352] TRACE [Controller 2]: All leaders = [messages-replicated-part3,0] -> (Leader:2,ISR:2,1,LeaderEpoch:4,ControllerEpoch:6),[messages-replicated,0] -> (Leader:1,ISR:2,1,LeaderEpoch:10,ControllerEpoch:6),[messages-replicated-part3,1] -> (Leader:1,ISR:1,2,LeaderEpoch:4,ControllerEpoch:6),[messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:3,ControllerEpoch:6),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:6) (kafka.controller.KafkaController)
[2015-08-10 12:27:38,629] WARN [Controller-2-to-broker-0-send-thread], Controller 2 epoch 6 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 23; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,2] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.EOFException: Received -1 when reading from channel, socket has likely been closed.
	at kafka.utils.Utils$.read(Utils.scala:381)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:27:38,630] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:27:38,930] WARN [Controller-2-to-broker-0-send-thread], Controller 2 epoch 6 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 23; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,2] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:27:38,931] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:27:39,017] INFO [Controller 2]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-10 12:27:39,017] DEBUG [Controller 2]: All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2015-08-10 12:27:39,017] DEBUG [Controller 2]: Live brokers: 2 (kafka.controller.KafkaController)
[2015-08-10 12:27:39,017] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:39,019] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages-replicated,0] : current leader = 1, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 12:27:39,020] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6), [messages-replicated-part3,0] -> (Leader:2,ISR:2,1,LeaderEpoch:4,ControllerEpoch:6), [messages-replicated-part3,1] -> (Leader:1,ISR:1,2,LeaderEpoch:4,ControllerEpoch:6), [messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:3,ControllerEpoch:6), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:39,021] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:39,021] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=messages-replicated-part3,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:39,021] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated-part3,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:27:39,021] DEBUG [Controller 2]: Removing replica 1 from ISR 2,1 for partition [messages-replicated-part3,0]. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,024] INFO [Controller 2]: New leader and ISR for partition [messages-replicated-part3,0] is {"leader":2,"leader_epoch":5,"isr":[2]} (kafka.controller.KafkaController)
[2015-08-10 12:27:39,024] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:39,024] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=messages-replicated-part3,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:39,024] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,1] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:39,027] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages-replicated-part3,1] : current leader = 1, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 12:27:39,033] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6), [messages-replicated-part3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6), [messages-replicated-part3,1] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6), [messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:3,ControllerEpoch:6), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:39,034] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,2] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:39,036] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages-replicated-part3,2] : current leader = 1, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 12:27:39,037] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6), [messages-replicated-part3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6), [messages-replicated-part3,1] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6), [messages-replicated-part3,2] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:39,037] TRACE [Controller 2]: All leaders = [messages-replicated-part3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),[messages-replicated,0] -> (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6),[messages-replicated-part3,1] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),[messages-replicated-part3,2] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:6) (kafka.controller.KafkaController)
[2015-08-10 12:27:39,042] WARN [Controller-2-to-broker-1-send-thread], Controller 2 epoch 6 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 32; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,0] to broker id:1,host:localhost.localdomain,port:9093. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.EOFException: Received -1 when reading from channel, socket has likely been closed.
	at kafka.utils.Utils$.read(Utils.scala:381)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:27:39,044] INFO [Controller-2-to-broker-1-send-thread], Controller 2 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:27:39,062] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:27:39,067] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: , deleted brokers: 0, all live brokers: 2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:27:39,067] INFO [Controller-2-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 12:27:39,068] ERROR [Controller-2-to-broker-0-send-thread], Controller 2 fails to send a request to broker id:0,host:localhost.localdomain,port:9092 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:152)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:27:39,068] INFO [Controller-2-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 12:27:39,068] INFO [Controller-2-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 12:27:39,068] INFO [Controller 2]: Broker failure callback for 0 (kafka.controller.KafkaController)
[2015-08-10 12:27:39,068] INFO [Controller 2]: Removed ArrayBuffer(0) from list of shutting down brokers. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,068] INFO [Partition state machine on Controller 2]: Invoking state change to OfflinePartition for partitions [messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:39,073] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:27:39,074] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=1,Replica=0],[Topic=messages-replicated-part3,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:27:39,074] DEBUG [Controller 2]: Removing replica 0 from ISR 2 for partition [messages-replicated,0]. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,077] WARN [Controller 2]: Cannot remove replica 0 from ISR of partition [messages-replicated,0] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-08-10 12:27:39,077] DEBUG [Controller 2]: Removing replica 0 from ISR 0 for partition [messages,0]. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,082] INFO [Controller 2]: New leader and ISR for partition [messages,0] is {"leader":-1,"leader_epoch":8,"isr":[]} (kafka.controller.KafkaController)
[2015-08-10 12:27:39,083] DEBUG [Controller 2]: Removing replica 0 from ISR 2 for partition [messages-replicated-part3,1]. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,085] WARN [Controller 2]: Cannot remove replica 0 from ISR of partition [messages-replicated-part3,1] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-08-10 12:27:39,085] DEBUG [Controller 2]: Removing replica 0 from ISR 2 for partition [messages-replicated-part3,0]. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,087] WARN [Controller 2]: Cannot remove replica 0 from ISR of partition [messages-replicated-part3,0] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-08-10 12:27:39,087] DEBUG [Controller 2]: Removing replica 0 from ISR 2 for partition [messages-replicated-part3,2]. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,090] WARN [Controller 2]: Cannot remove replica 0 from ISR of partition [messages-replicated-part3,2] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-08-10 12:27:39,091] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:39,091] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=1,Replica=0],[Topic=messages-replicated-part3,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:39,091] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 37; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated,0] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:27:39,091] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 37; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages,0] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:27:39,091] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 37; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,1] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:27:39,091] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 37; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,0] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:27:39,091] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 37; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,2] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:27:39,345] WARN [Controller-2-to-broker-1-send-thread], Controller 2 epoch 6 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 32; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,0] to broker id:1,host:localhost.localdomain,port:9093. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:27:39,346] INFO [Controller-2-to-broker-1-send-thread], Controller 2 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:27:39,510] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:27:39,515] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: , deleted brokers: 1, all live brokers: 2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:27:39,516] INFO [Controller-2-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 12:27:39,518] ERROR [Controller-2-to-broker-1-send-thread], Controller 2 fails to send a request to broker id:1,host:localhost.localdomain,port:9093 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:152)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:27:39,518] INFO [Controller-2-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 12:27:39,518] INFO [Controller-2-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 12:27:39,518] INFO [Controller 2]: Broker failure callback for 1 (kafka.controller.KafkaController)
[2015-08-10 12:27:39,519] INFO [Controller 2]: Removed ArrayBuffer(1) from list of shutting down brokers. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,519] INFO [Partition state machine on Controller 2]: Invoking state change to OfflinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:39,522] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:27:39,522] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=1,Replica=1],[Topic=messages-replicated-part3,Partition=2,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:27:39,522] DEBUG [Controller 2]: Removing replica 1 from ISR 2 for partition [messages-replicated,0]. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,524] WARN [Controller 2]: Cannot remove replica 1 from ISR of partition [messages-replicated,0] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-08-10 12:27:39,525] DEBUG [Controller 2]: Removing replica 1 from ISR 2 for partition [messages-replicated-part3,0]. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,526] WARN [Controller 2]: Cannot remove replica 1 from ISR of partition [messages-replicated-part3,0] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-08-10 12:27:39,527] DEBUG [Controller 2]: Removing replica 1 from ISR 2 for partition [messages-replicated-part3,1]. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,528] WARN [Controller 2]: Cannot remove replica 1 from ISR of partition [messages-replicated-part3,1] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-08-10 12:27:39,528] DEBUG [Controller 2]: Removing replica 1 from ISR 2 for partition [messages-replicated-part3,2]. (kafka.controller.KafkaController)
[2015-08-10 12:27:39,531] WARN [Controller 2]: Cannot remove replica 1 from ISR of partition [messages-replicated-part3,2] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-08-10 12:27:39,531] WARN [Channel manager on controller 2]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:2;ControllerEpoch:6;CorrelationId:40;ClientId:id_2-host_null-port_9094;Leaders:id:2,host:localhost.localdomain,port:9094;PartitionState:(messages-replicated-part3,0) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:2,0,1),(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0),(messages-replicated-part3,1) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2),(messages-replicated-part3,2) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:27:39,531] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:39,531] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=messages-replicated,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=1,Replica=1],[Topic=messages-replicated-part3,Partition=2,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:27:39,531] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 40; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated,0] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:27:39,532] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 40; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,0] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:27:39,532] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 40; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,1] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:27:39,532] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 40; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,2] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:27:40,383] INFO [Controller 2]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-08-10 12:27:40,384] DEBUG [Controller 2]: All shutting down brokers: 2 (kafka.controller.KafkaController)
[2015-08-10 12:27:40,384] DEBUG [Controller 2]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 12:27:40,384] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:40,390] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:40,394] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,1] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:40,398] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,2] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:40,401] TRACE [Controller 2]: All leaders = [messages-replicated-part3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),[messages-replicated,0] -> (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6),[messages-replicated-part3,1] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),[messages-replicated-part3,2] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6),[messages,0] -> (Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6) (kafka.controller.KafkaController)
[2015-08-10 12:27:45,412] INFO [Controller 2]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-08-10 12:27:45,412] DEBUG [Controller 2]: All shutting down brokers: 2 (kafka.controller.KafkaController)
[2015-08-10 12:27:45,412] DEBUG [Controller 2]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 12:27:45,412] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:45,417] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:45,420] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,1] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:45,424] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,2] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:45,427] TRACE [Controller 2]: All leaders = [messages-replicated-part3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),[messages-replicated,0] -> (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6),[messages-replicated-part3,1] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),[messages-replicated-part3,2] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6),[messages,0] -> (Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6) (kafka.controller.KafkaController)
[2015-08-10 12:27:50,433] INFO [Controller 2]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-08-10 12:27:50,433] DEBUG [Controller 2]: All shutting down brokers: 2 (kafka.controller.KafkaController)
[2015-08-10 12:27:50,433] DEBUG [Controller 2]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 12:27:50,433] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:50,438] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:50,443] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,1] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:50,446] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,2] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:50,449] TRACE [Controller 2]: All leaders = [messages-replicated-part3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),[messages-replicated,0] -> (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:6),[messages-replicated-part3,1] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),[messages-replicated-part3,2] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6),[messages,0] -> (Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6) (kafka.controller.KafkaController)
[2015-08-10 12:27:55,576] INFO [Partition state machine on Controller 2]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 12:27:55,576] INFO [Replica state machine on controller 2]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:27:55,577] INFO [Controller-2-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 12:27:55,578] INFO [Controller-2-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 12:27:55,578] INFO [Controller-2-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 12:28:08,972] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 12:28:08,994] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 12:28:09,003] INFO [Controller 0]: Initialized controller epoch to 6 and zk version 5 (kafka.controller.KafkaController)
[2015-08-10 12:28:09,008] INFO [Controller 0]: Controller 0 incremented epoch to 7 (kafka.controller.KafkaController)
[2015-08-10 12:28:09,087] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:28:09,088] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:28:09,089] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 12:28:09,092] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 12:28:09,093] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 12:28:09,094] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 12:28:09,100] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 12:28:09,101] INFO [Controller 0]: List of topics ineligible for deletion: messages-replicated,messages-replicated-part3,messages (kafka.controller.KafkaController)
[2015-08-10 12:28:09,104] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:28:09,105] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:28:09,105] INFO [Controller 0]: Current list of topics in the cluster: Set(messages, messages-replicated, messages-replicated-part3) (kafka.controller.KafkaController)
[2015-08-10 12:28:09,112] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=messages-replicated-part3,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=messages,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=2,Replica=1] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=1,Replica=1] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=2,Replica=2] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:28:09,129] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,140] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,147] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,153] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,159] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,163] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([messages-replicated,0] -> OfflinePartition, [messages-replicated-part3,0] -> OfflinePartition, [messages-replicated-part3,1] -> OfflinePartition, [messages-replicated-part3,2] -> OfflinePartition, [messages,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:28:09,166] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 7 (kafka.controller.KafkaController)
[2015-08-10 12:28:09,167] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 12:28:09,168] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 12:28:09,179] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 12:28:09,180] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 12:28:09,193] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:28:09,216] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:28:09,217] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-08-10 12:28:09,222] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:28:09,223] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 12:28:09,223] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-08-10 12:28:09,232] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=1,Replica=0],[Topic=messages-replicated-part3,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:28:09,252] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,252] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,254] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":12,"isr":[0]} for offline partition [messages-replicated,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,258] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7), [messages-replicated-part3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6), [messages-replicated-part3,1] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6), [messages-replicated-part3,2] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6), [messages,0] -> (Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:28:09,264] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,265] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,265] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":6,"isr":[0]} for offline partition [messages-replicated-part3,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,267] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,1] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6), [messages-replicated-part3,2] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6), [messages,0] -> (Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:28:09,273] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,1]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,273] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,1]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,273] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":6,"isr":[0]} for offline partition [messages-replicated-part3,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,275] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,1] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,2] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:6), [messages,0] -> (Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:28:09,282] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,2]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,282] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,2]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,282] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":5,"isr":[0]} for offline partition [messages-replicated-part3,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,284] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,1] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,2] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7), [messages,0] -> (Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:28:09,289] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,289] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,289] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":9,"isr":[0]} for offline partition [messages,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:28:09,291] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:7), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,1] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,2] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:28:14,181] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:28:14,185] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 12:28:14,186] DEBUG [Controller 0]: topics not in preferred replica Map([messages-replicated-part3,0] -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2015-08-10 12:28:14,187] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 1.000000 (kafka.controller.KafkaController)
[2015-08-10 12:28:14,188] DEBUG [Controller 0]: topics not in preferred replica Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-08-10 12:28:14,188] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-08-10 12:28:14,188] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:28:14,188] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:32:03,067] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 12:32:03,083] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 12:32:03,109] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:32:03,132] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 1, deleted brokers: , all live brokers: 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:32:03,132] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 12:32:03,133] INFO [Controller-0-to-broker-1-send-thread], Controller 0 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:32:03,135] INFO [Controller-0-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 12:32:03,135] INFO [Controller 0]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 12:32:03,138] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=1,Replica=1],[Topic=messages-replicated-part3,Partition=2,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:33:14,180] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:33:14,182] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 12:33:14,182] DEBUG [Controller 0]: topics not in preferred replica Map([messages-replicated-part3,0] -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2015-08-10 12:33:14,182] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 1.000000 (kafka.controller.KafkaController)
[2015-08-10 12:33:14,183] DEBUG [Controller 0]: topics not in preferred replica Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-08-10 12:33:14,183] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-08-10 12:33:14,184] INFO [Controller 0]: Starting preferred replica leader election for partitions [messages-replicated,0] (kafka.controller.KafkaController)
[2015-08-10 12:33:14,184] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,036] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-08-10 12:33:33,560] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [messages-replicated,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2015-08-10 12:33:33,567] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,1] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,2] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,568] WARN [Channel manager on controller 0]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:7;CorrelationId:9;ClientId:id_0-host_null-port_9092;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:33:33,572] INFO [Controller 0]: Partition [messages-replicated,0] completed preferred replica leader election. New leader is 1 (kafka.controller.KafkaController)
[2015-08-10 12:33:33,572] INFO [Controller 0]: Starting preferred replica leader election for partitions [messages-replicated-part3,2] (kafka.controller.KafkaController)
[2015-08-10 12:33:33,573] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,2] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,573] INFO [Controller 0]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-08-10 12:33:33,578] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [messages-replicated-part3,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2015-08-10 12:33:33,580] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:0,1,LeaderEpoch:13,ControllerEpoch:7), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,1] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,2] -> (Leader:1,ISR:0,1,LeaderEpoch:6,ControllerEpoch:7), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,580] WARN [Channel manager on controller 0]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:7;CorrelationId:10;ClientId:id_0-host_null-port_9092;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated-part3,2) -> (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:33:33,581] INFO [Controller 0]: Partition [messages-replicated-part3,2] completed preferred replica leader election. New leader is 1 (kafka.controller.KafkaController)
[2015-08-10 12:33:33,581] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:33:33,581] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:33:33,582] DEBUG [Controller 0]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-08-10 12:33:33,583] DEBUG [Controller 0]: Live brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 12:33:33,590] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:33:33,590] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:33:33,592] INFO [Replica state machine on controller 0]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:33:33,593] DEBUG [Controller 0]: Removing replica 0 from ISR 0,1 for partition [messages-replicated-part3,2]. (kafka.controller.KafkaController)
[2015-08-10 12:33:33,600] INFO [Controller 0]: New leader and ISR for partition [messages-replicated-part3,2] is {"leader":1,"leader_epoch":7,"isr":[1]} (kafka.controller.KafkaController)
[2015-08-10 12:33:33,602] WARN [Channel manager on controller 0]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:7;CorrelationId:12;ClientId:id_0-host_null-port_9092;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated-part3,2) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:33:33,602] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:33:33,602] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:33:33,602] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:33:33,602] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:33:33,602] INFO [Replica state machine on controller 0]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:33:33,603] DEBUG [Controller 0]: Removing replica 0 from ISR 0,1 for partition [messages-replicated,0]. (kafka.controller.KafkaController)
[2015-08-10 12:33:33,608] INFO [Controller 0]: New leader and ISR for partition [messages-replicated,0] is {"leader":1,"leader_epoch":14,"isr":[1]} (kafka.controller.KafkaController)
[2015-08-10 12:33:33,609] WARN [Channel manager on controller 0]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:7;CorrelationId:14;ClientId:id_0-host_null-port_9092;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:1,2,0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:33:33,609] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:33:33,609] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:33:33,609] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,1] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,615] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages-replicated-part3,1] : current leader = 0, new leader = 1 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 12:33:33,617] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [messages-replicated-part3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7), [messages-replicated-part3,2] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,617] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,620] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages-replicated-part3,0] : current leader = 0, new leader = 1 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 12:33:33,623] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7), [messages-replicated-part3,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7), [messages-replicated-part3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7), [messages-replicated-part3,2] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,626] TRACE [Controller 0]: All leaders = [messages-replicated-part3,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages-replicated,0] -> (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),[messages-replicated-part3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages-replicated-part3,2] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7) (kafka.controller.KafkaController)
[2015-08-10 12:33:33,627] INFO [Controller 0]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-10 12:33:33,627] DEBUG [Controller 0]: All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2015-08-10 12:33:33,627] DEBUG [Controller 0]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 12:33:33,628] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,634] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,640] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,1] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,647] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,2] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,655] TRACE [Controller 0]: All leaders = [messages-replicated-part3,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages-replicated,0] -> (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),[messages-replicated-part3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages-replicated-part3,2] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7) (kafka.controller.KafkaController)
[2015-08-10 12:33:33,747] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,748] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:33:33,749] INFO [Controller-0-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 12:33:33,750] INFO [Controller-0-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 12:33:33,750] INFO [Controller-0-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 12:33:33,750] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 12:33:33,750] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 12:33:33,750] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 12:33:33,776] INFO [Controller 1]: Broker 1 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 12:33:33,779] INFO [Controller 1]: Initialized controller epoch to 7 and zk version 6 (kafka.controller.KafkaController)
[2015-08-10 12:33:33,783] INFO [Controller 1]: Controller 1 incremented epoch to 8 (kafka.controller.KafkaController)
[2015-08-10 12:33:33,851] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 12:33:33,853] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:33:33,855] INFO [Controller-1-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 12:33:33,860] INFO [Controller 1]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:33:33,860] INFO [Controller 1]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:33:33,861] INFO [Controller 1]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 12:33:33,864] INFO [Controller 1]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 12:33:33,864] INFO [Controller 1]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 12:33:33,866] INFO [Controller 1]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 12:33:33,870] INFO [Controller 1]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 12:33:33,871] INFO [Controller 1]: List of topics ineligible for deletion: messages-replicated,messages-replicated-part3,messages (kafka.controller.KafkaController)
[2015-08-10 12:33:33,873] INFO [Controller 1]: Currently active brokers in the cluster: Set(1) (kafka.controller.KafkaController)
[2015-08-10 12:33:33,874] INFO [Controller 1]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:33:33,874] INFO [Controller 1]: Current list of topics in the cluster: Set(messages, messages-replicated, messages-replicated-part3) (kafka.controller.KafkaController)
[2015-08-10 12:33:33,879] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=1,Replica=1],[Topic=messages-replicated-part3,Partition=2,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:33:33,890] INFO [Replica state machine on controller 1]: Started replica state machine with initial state -> Map([Topic=messages-replicated-part3,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=messages,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=2,Replica=1] -> OnlineReplica, [Topic=messages-replicated-part3,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=1] -> OnlineReplica, [Topic=messages-replicated-part3,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=0,Replica=1] -> OnlineReplica, [Topic=messages-replicated-part3,Partition=1,Replica=1] -> OnlineReplica, [Topic=messages-replicated-part3,Partition=2,Replica=2] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:33:33,903] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:33:33,906] INFO [Partition state machine on Controller 1]: Started partition state machine with initial state -> Map([messages-replicated,0] -> OnlinePartition, [messages-replicated-part3,0] -> OnlinePartition, [messages-replicated-part3,1] -> OnlinePartition, [messages-replicated-part3,2] -> OnlinePartition, [messages,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,909] INFO [Controller 1]: Broker 1 is ready to serve as the new controller with epoch 8 (kafka.controller.KafkaController)
[2015-08-10 12:33:33,911] INFO [Controller 1]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 12:33:33,911] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:33,918] INFO [Controller 1]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 12:33:38,666] INFO [Controller 1]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-10 12:33:38,667] DEBUG [Controller 1]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 12:33:38,667] DEBUG [Controller 1]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 12:33:38,670] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:38,677] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:38,681] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,1] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:38,685] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,2] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:38,692] TRACE [Controller 1]: All leaders = [messages-replicated-part3,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages-replicated,0] -> (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),[messages-replicated-part3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages-replicated-part3,2] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7) (kafka.controller.KafkaController)
[2015-08-10 12:33:38,920] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:33:38,925] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 12:33:38,926] DEBUG [Controller 1]: topics not in preferred replica Map([messages-replicated-part3,0] -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2015-08-10 12:33:38,927] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 1.000000 (kafka.controller.KafkaController)
[2015-08-10 12:33:38,928] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:33:38,928] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:33:38,928] DEBUG [Controller 1]: topics not in preferred replica Map([messages-replicated-part3,1] -> List(0, 1, 2)) (kafka.controller.KafkaController)
[2015-08-10 12:33:38,928] TRACE [Controller 1]: leader imbalance ratio for broker 0 is 0.500000 (kafka.controller.KafkaController)
[2015-08-10 12:33:43,711] INFO [Controller 1]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-10 12:33:43,711] DEBUG [Controller 1]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 12:33:43,711] DEBUG [Controller 1]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 12:33:43,712] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:43,717] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:43,722] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,1] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:43,726] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,2] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:43,730] TRACE [Controller 1]: All leaders = [messages-replicated-part3,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages-replicated,0] -> (Leader:1,ISR:1,LeaderEpoch:14,ControllerEpoch:7),[messages-replicated-part3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages-replicated-part3,2] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7) (kafka.controller.KafkaController)
[2015-08-10 12:33:49,016] INFO [Partition state machine on Controller 1]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 12:33:49,016] INFO [Replica state machine on controller 1]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:33:49,017] INFO [Controller-1-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 12:33:49,018] INFO [Controller-1-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 12:33:49,018] INFO [Controller-1-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 12:34:08,079] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-08-10 12:34:15,422] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 12:34:15,456] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 12:34:15,466] INFO [Controller 0]: Initialized controller epoch to 8 and zk version 7 (kafka.controller.KafkaController)
[2015-08-10 12:34:15,471] INFO [Controller 0]: Controller 0 incremented epoch to 9 (kafka.controller.KafkaController)
[2015-08-10 12:34:15,567] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:34:15,568] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:34:15,568] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 12:34:15,572] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 12:34:15,573] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 12:34:15,574] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 12:34:15,579] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 12:34:15,580] INFO [Controller 0]: List of topics ineligible for deletion: messages-replicated,messages-replicated-part3,messages (kafka.controller.KafkaController)
[2015-08-10 12:34:15,583] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:34:15,584] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:34:15,584] INFO [Controller 0]: Current list of topics in the cluster: Set(messages, messages-replicated, messages-replicated-part3) (kafka.controller.KafkaController)
[2015-08-10 12:34:15,591] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=messages-replicated-part3,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=messages,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=2,Replica=1] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=1,Replica=1] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=2,Replica=2] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:34:15,609] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,624] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,634] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,642] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,651] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,656] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([messages-replicated,0] -> OfflinePartition, [messages-replicated-part3,0] -> OfflinePartition, [messages-replicated-part3,1] -> OfflinePartition, [messages-replicated-part3,2] -> OfflinePartition, [messages,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:34:15,660] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 9 (kafka.controller.KafkaController)
[2015-08-10 12:34:15,661] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 12:34:15,662] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 12:34:15,670] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 12:34:15,671] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 12:34:15,683] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:34:15,704] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:34:15,705] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-08-10 12:34:15,710] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:34:15,711] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 12:34:15,711] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-08-10 12:34:15,720] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=1,Replica=0],[Topic=messages-replicated-part3,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:34:15,740] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,741] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,742] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":15,"isr":[0]} for offline partition [messages-replicated,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,748] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9), [messages-replicated-part3,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7), [messages-replicated-part3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7), [messages-replicated-part3,2] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:34:15,755] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,755] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,755] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":8,"isr":[0]} for offline partition [messages-replicated-part3,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,759] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages-replicated-part3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7), [messages-replicated-part3,2] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:34:15,766] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,1]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,767] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,1]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,767] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":8,"isr":[0]} for offline partition [messages-replicated-part3,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,769] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages-replicated-part3,1] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages-replicated-part3,2] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:7), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:34:15,774] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,2]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,775] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages-replicated-part3,2]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,775] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":8,"isr":[0]} for offline partition [messages-replicated-part3,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,777] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages-replicated-part3,1] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages-replicated-part3,2] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:34:15,781] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [messages,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,782] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":10,"isr":[0]} for offline partition [messages,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 12:34:15,784] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:9), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages-replicated-part3,1] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages-replicated-part3,2] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:34:20,419] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 12:34:20,435] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 12:34:20,458] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:34:20,469] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 1, deleted brokers: , all live brokers: 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:34:20,469] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 12:34:20,469] INFO [Controller-0-to-broker-1-send-thread], Controller 0 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:34:20,470] INFO [Controller-0-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 12:34:20,470] INFO [Controller 0]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 12:34:20,472] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=1,Replica=1],[Topic=messages-replicated-part3,Partition=2,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:34:20,672] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:34:20,674] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 12:34:20,677] DEBUG [Controller 0]: topics not in preferred replica Map([messages-replicated-part3,0] -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2015-08-10 12:34:20,678] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 1.000000 (kafka.controller.KafkaController)
[2015-08-10 12:34:20,679] DEBUG [Controller 0]: topics not in preferred replica Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-08-10 12:34:20,679] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-08-10 12:34:20,679] INFO [Controller 0]: Starting preferred replica leader election for partitions [messages-replicated,0] (kafka.controller.KafkaController)
[2015-08-10 12:34:20,680] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:34:20,686] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [messages-replicated,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2015-08-10 12:34:20,688] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages-replicated-part3,1] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages-replicated-part3,2] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:34:20,689] WARN [Channel manager on controller 0]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:9;CorrelationId:9;ClientId:id_0-host_null-port_9092;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:34:20,690] INFO [Controller 0]: Partition [messages-replicated,0] completed preferred replica leader election. New leader is 1 (kafka.controller.KafkaController)
[2015-08-10 12:34:20,690] INFO [Controller 0]: Starting preferred replica leader election for partitions [messages-replicated-part3,2] (kafka.controller.KafkaController)
[2015-08-10 12:34:20,690] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,2] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:34:20,694] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [messages-replicated-part3,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2015-08-10 12:34:20,697] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:0,1,LeaderEpoch:16,ControllerEpoch:9), [messages-replicated-part3,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages-replicated-part3,1] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [messages-replicated-part3,2] -> (Leader:1,ISR:0,1,LeaderEpoch:9,ControllerEpoch:9), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:34:20,697] WARN [Channel manager on controller 0]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:9;CorrelationId:10;ClientId:id_0-host_null-port_9092;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated-part3,2) -> (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:1,2,0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:34:20,698] INFO [Controller 0]: Partition [messages-replicated-part3,2] completed preferred replica leader election. New leader is 1 (kafka.controller.KafkaController)
[2015-08-10 12:34:20,698] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:34:20,698] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:35:59,987] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-08-10 12:36:38,539] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-08-10 12:36:41,574] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 12:36:41,602] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 12:36:41,610] INFO [Controller 0]: Controller 0 incremented epoch to 1 (kafka.controller.KafkaController)
[2015-08-10 12:36:41,632] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:36:41,632] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:36:41,633] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 12:36:41,637] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 12:36:41,637] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 12:36:41,638] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 12:36:41,642] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 12:36:41,643] INFO [Controller 0]: List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2015-08-10 12:36:41,647] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:36:41,647] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:36:41,647] INFO [Controller 0]: Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:36:41,650] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map() (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:36:41,656] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map() (kafka.controller.PartitionStateMachine)
[2015-08-10 12:36:41,656] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2015-08-10 12:36:41,657] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 12:36:41,658] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 12:36:41,664] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 12:36:41,665] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 12:36:41,745] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:36:41,788] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:36:41,789] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-08-10 12:36:41,793] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:36:41,795] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 12:36:41,795] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-08-10 12:36:43,319] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 12:36:43,417] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 12:36:43,441] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:36:43,469] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 1, deleted brokers: , all live brokers: 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:36:43,469] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 12:36:43,470] INFO [Controller-0-to-broker-1-send-thread], Controller 0 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:36:43,470] INFO [Controller 0]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 12:36:43,470] INFO [Controller-0-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 12:36:46,667] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:36:46,672] DEBUG [Controller 0]: preferred replicas by broker Map() (kafka.controller.KafkaController)
[2015-08-10 12:37:45,053] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children messages (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-08-10 12:37:45,069] INFO [TopicChangeListener on Controller 0]: New topics: [Set(messages)], deleted topics: [Set()], new partition replica assignment [Map([messages,0] -> List(1, 0))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-08-10 12:37:45,070] INFO [Controller 0]: New topic creation callback for [messages,0] (kafka.controller.KafkaController)
[2015-08-10 12:37:45,075] INFO [Controller 0]: New partition creation callback for [messages,0] (kafka.controller.KafkaController)
[2015-08-10 12:37:45,076] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:37:45,088] INFO [Replica state machine on controller 0]: Invoking state change to NewReplica for replicas [Topic=messages,Partition=0,Replica=1],[Topic=messages,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:37:45,095] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:37:45,097] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [messages,0] are: [List(1, 0)] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:37:45,099] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [messages,0] to (Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:37:45,129] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages,Partition=0,Replica=1],[Topic=messages,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:41:46,665] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:41:46,666] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([messages,0] -> List(1, 0))) (kafka.controller.KafkaController)
[2015-08-10 12:41:46,670] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:41:46,673] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:46:46,664] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:46:46,665] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([messages,0] -> List(1, 0))) (kafka.controller.KafkaController)
[2015-08-10 12:46:46,666] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:46:46,666] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:50:50,077] INFO [Controller 0]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-10 12:50:50,079] DEBUG [Controller 0]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 12:50:50,080] DEBUG [Controller 0]: Live brokers: 0 (kafka.controller.KafkaController)
[2015-08-10 12:50:50,086] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:50:50,097] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages,0] : current leader = 1, new leader = 0 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 12:50:50,103] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:50:50,106] WARN [Controller-0-to-broker-0-send-thread], Controller 0 epoch 1 fails to send request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:1;CorrelationId:11;ClientId:id_0-host_null-port_9092;Leaders:id:0,host:localhost.localdomain,port:9092;PartitionState:(messages,0) -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.EOFException: Received -1 when reading from channel, socket has likely been closed.
	at kafka.utils.Utils$.read(Utils.scala:381)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:50:50,106] TRACE [Controller 0]: All leaders = [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1) (kafka.controller.KafkaController)
[2015-08-10 12:50:50,106] WARN [Controller-0-to-broker-1-send-thread], Controller 0 epoch 1 fails to send request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:1;CorrelationId:11;ClientId:id_0-host_null-port_9092;Leaders:id:0,host:localhost.localdomain,port:9092;PartitionState:(messages,0) -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:1,0) to broker id:1,host:localhost.localdomain,port:9093. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.EOFException: Received -1 when reading from channel, socket has likely been closed.
	at kafka.utils.Utils$.read(Utils.scala:381)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:50:50,112] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:50:50,112] INFO [Controller-0-to-broker-1-send-thread], Controller 0 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:50:50,384] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:50:50,387] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: 1, all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:50:50,388] INFO [Controller-0-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 12:50:50,390] ERROR [Controller-0-to-broker-1-send-thread], Controller 0 fails to send a request to broker id:1,host:localhost.localdomain,port:9093 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:150)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:50:50,390] INFO [Controller-0-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 12:50:50,390] INFO [Controller-0-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 12:50:50,391] INFO [Controller 0]: Broker failure callback for 1 (kafka.controller.KafkaController)
[2015-08-10 12:50:50,391] INFO [Controller 0]: Removed ArrayBuffer(1) from list of shutting down brokers. (kafka.controller.KafkaController)
[2015-08-10 12:50:50,392] INFO [Partition state machine on Controller 0]: Invoking state change to OfflinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 12:50:50,393] INFO [Replica state machine on controller 0]: Invoking state change to OfflineReplica for replicas [Topic=messages,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:50:50,396] DEBUG [Controller 0]: Removing replica 1 from ISR 0 for partition [messages,0]. (kafka.controller.KafkaController)
[2015-08-10 12:50:50,400] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [messages,0] since it is not in the ISR. Leader = 0 ; ISR = List(0) (kafka.controller.KafkaController)
[2015-08-10 12:50:50,402] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:50:50,402] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=messages,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:50:50,405] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 14; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 1; Partitions: [messages,0] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 12:50:52,917] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 12:50:52,940] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 12:50:52,966] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:50:52,996] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 1, deleted brokers: , all live brokers: 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:50:52,996] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 12:50:52,997] INFO [Controller-0-to-broker-1-send-thread], Controller 0 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:50:52,997] INFO [Controller 0]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 12:50:52,997] INFO [Controller-0-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 12:50:52,997] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:51:46,664] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:51:46,665] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([messages,0] -> List(1, 0))) (kafka.controller.KafkaController)
[2015-08-10 12:51:46,665] DEBUG [Controller 0]: topics not in preferred replica Map([messages,0] -> List(1, 0)) (kafka.controller.KafkaController)
[2015-08-10 12:51:46,666] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-08-10 12:51:46,669] INFO [Controller 0]: Starting preferred replica leader election for partitions [messages,0] (kafka.controller.KafkaController)
[2015-08-10 12:51:46,669] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:51:46,676] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [messages,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2015-08-10 12:51:46,678] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages,0] -> (Leader:1,ISR:0,1,LeaderEpoch:2,ControllerEpoch:1)) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:51:46,679] INFO [Controller 0]: Partition [messages,0] completed preferred replica leader election. New leader is 1 (kafka.controller.KafkaController)
[2015-08-10 12:56:46,664] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:56:46,665] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([messages,0] -> List(1, 0))) (kafka.controller.KafkaController)
[2015-08-10 12:56:46,665] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:56:46,665] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:57:48,398] INFO [Controller 0]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-08-10 12:57:48,398] DEBUG [Controller 0]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-08-10 12:57:48,398] DEBUG [Controller 0]: Live brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 12:57:48,399] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:57:48,400] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:57:48,400] INFO [Replica state machine on controller 0]: Invoking state change to OfflineReplica for replicas [Topic=messages,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:57:48,400] DEBUG [Controller 0]: Removing replica 0 from ISR 0,1 for partition [messages,0]. (kafka.controller.KafkaController)
[2015-08-10 12:57:48,409] INFO [Controller 0]: New leader and ISR for partition [messages,0] is {"leader":1,"leader_epoch":3,"isr":[1]} (kafka.controller.KafkaController)
[2015-08-10 12:57:48,410] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:57:48,410] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 12:57:48,410] TRACE [Controller 0]: All leaders = [messages,0] -> (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1) (kafka.controller.KafkaController)
[2015-08-10 12:57:48,416] WARN [Controller-0-to-broker-0-send-thread], Controller 0 epoch 1 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 20; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 1; Partitions: [messages,0] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.EOFException: Received -1 when reading from channel, socket has likely been closed.
	at kafka.utils.Utils$.read(Utils.scala:381)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:57:48,416] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:57:48,717] WARN [Controller-0-to-broker-0-send-thread], Controller 0 epoch 1 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 20; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 1; Partitions: [messages,0] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:57:48,718] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:57:49,018] WARN [Controller-0-to-broker-0-send-thread], Controller 0 epoch 1 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 20; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 1; Partitions: [messages,0] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:57:49,019] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:57:49,021] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 12:57:49,022] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:57:49,023] INFO [Controller-0-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 12:57:49,023] INFO [Controller-0-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 12:57:49,023] INFO [Controller-0-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 12:57:49,023] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 12:57:49,024] ERROR [Controller-0-to-broker-0-send-thread], Controller 0 fails to send a request to broker id:0,host:localhost.localdomain,port:9092 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:152)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 12:57:49,024] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 12:57:49,024] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 12:57:49,047] INFO [Controller 1]: Broker 1 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 12:57:49,050] INFO [Controller 1]: Initialized controller epoch to 1 and zk version 0 (kafka.controller.KafkaController)
[2015-08-10 12:57:49,055] INFO [Controller 1]: Controller 1 incremented epoch to 2 (kafka.controller.KafkaController)
[2015-08-10 12:57:49,095] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 12:57:49,097] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:57:49,099] INFO [Controller-1-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 12:57:49,101] INFO [Controller 1]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:57:49,101] INFO [Controller 1]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:57:49,101] INFO [Controller 1]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 12:57:49,105] INFO [Controller 1]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 12:57:49,105] INFO [Controller 1]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 12:57:49,106] INFO [Controller 1]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 12:57:49,111] INFO [Controller 1]: List of topics to be deleted: messages (kafka.controller.KafkaController)
[2015-08-10 12:57:49,111] INFO [Controller 1]: List of topics ineligible for deletion: messages (kafka.controller.KafkaController)
[2015-08-10 12:57:49,115] INFO [Controller 1]: Currently active brokers in the cluster: Set(1) (kafka.controller.KafkaController)
[2015-08-10 12:57:49,115] INFO [Controller 1]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:57:49,115] INFO [Controller 1]: Current list of topics in the cluster: Set(messages) (kafka.controller.KafkaController)
[2015-08-10 12:57:49,120] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=messages,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:57:49,129] INFO [Replica state machine on controller 1]: Started replica state machine with initial state -> Map([Topic=messages,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages,Partition=0,Replica=1] -> OnlineReplica) (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:57:49,135] INFO [Partition state machine on Controller 1]: Started partition state machine with initial state -> Map([messages,0] -> OnlinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:57:49,138] INFO [Controller 1]: Broker 1 is ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2015-08-10 12:57:49,139] INFO [Controller 1]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 12:57:49,140] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 12:57:49,145] INFO [Controller 1]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 12:57:52,037] INFO [Controller 1]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-10 12:57:52,038] DEBUG [Controller 1]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 12:57:52,038] DEBUG [Controller 1]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 12:57:52,040] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:57:52,052] TRACE [Controller 1]: All leaders = [messages,0] -> (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1) (kafka.controller.KafkaController)
[2015-08-10 12:57:54,147] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:57:54,153] DEBUG [Controller 1]: preferred replicas by broker Map(1 -> Map([messages,0] -> List(1, 0))) (kafka.controller.KafkaController)
[2015-08-10 12:57:54,156] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 12:57:54,156] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 12:57:57,070] INFO [Controller 1]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-10 12:57:57,070] DEBUG [Controller 1]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 12:57:57,071] DEBUG [Controller 1]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 12:57:57,071] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:57:57,078] TRACE [Controller 1]: All leaders = [messages,0] -> (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1) (kafka.controller.KafkaController)
[2015-08-10 12:58:02,089] INFO [Controller 1]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-10 12:58:02,089] DEBUG [Controller 1]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 12:58:02,089] DEBUG [Controller 1]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 12:58:02,090] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:58:02,099] TRACE [Controller 1]: All leaders = [messages,0] -> (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:1) (kafka.controller.KafkaController)
[2015-08-10 12:58:07,396] INFO [Partition state machine on Controller 1]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 12:58:07,397] INFO [Replica state machine on controller 1]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:58:07,398] INFO [Controller-1-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 12:58:07,398] INFO [Controller-1-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 12:58:07,398] INFO [Controller-1-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 12:58:23,223] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-08-10 12:58:26,978] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 12:58:27,006] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 12:58:27,012] INFO [Controller 0]: Controller 0 incremented epoch to 1 (kafka.controller.KafkaController)
[2015-08-10 12:58:27,035] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:58:27,036] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 12:58:27,036] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 12:58:27,041] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 12:58:27,042] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 12:58:27,044] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 12:58:27,049] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 12:58:27,050] INFO [Controller 0]: List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2015-08-10 12:58:27,053] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:58:27,054] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:58:27,054] INFO [Controller 0]: Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 12:58:27,056] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map() (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:58:27,061] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map() (kafka.controller.PartitionStateMachine)
[2015-08-10 12:58:27,062] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2015-08-10 12:58:27,063] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 12:58:27,064] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 12:58:27,069] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 12:58:27,070] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 12:58:27,139] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:58:27,167] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:58:27,168] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-08-10 12:58:27,174] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:58:27,175] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 12:58:27,175] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-08-10 12:58:30,008] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 12:58:30,101] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 12:58:30,122] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:58:30,146] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 1, deleted brokers: , all live brokers: 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 12:58:30,146] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 12:58:30,147] INFO [Controller-0-to-broker-1-send-thread], Controller 0 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 12:58:30,147] INFO [Controller 0]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 12:58:30,147] INFO [Controller-0-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 12:58:32,072] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 12:58:32,075] DEBUG [Controller 0]: preferred replicas by broker Map() (kafka.controller.KafkaController)
[2015-08-10 12:58:36,965] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children messages (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-08-10 12:58:36,975] INFO [TopicChangeListener on Controller 0]: New topics: [Set(messages)], deleted topics: [Set()], new partition replica assignment [Map([messages,1] -> List(1, 0), [messages,0] -> List(0, 1))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-08-10 12:58:36,975] INFO [Controller 0]: New topic creation callback for [messages,1],[messages,0] (kafka.controller.KafkaController)
[2015-08-10 12:58:36,978] INFO [Controller 0]: New partition creation callback for [messages,1],[messages,0] (kafka.controller.KafkaController)
[2015-08-10 12:58:36,978] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [messages,1],[messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:58:36,992] INFO [Replica state machine on controller 0]: Invoking state change to NewReplica for replicas [Topic=messages,Partition=1,Replica=1],[Topic=messages,Partition=1,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 12:58:37,000] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages,1],[messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:58:37,001] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [messages,1] are: [List(1, 0)] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:58:37,003] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [messages,1] to (Leader:1,ISR:1,0,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:58:37,016] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [messages,0] are: [List(0, 1)] (kafka.controller.PartitionStateMachine)
[2015-08-10 12:58:37,016] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [messages,0] to (Leader:0,ISR:0,1,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.PartitionStateMachine)
[2015-08-10 12:58:37,034] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages,Partition=1,Replica=1],[Topic=messages,Partition=1,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
