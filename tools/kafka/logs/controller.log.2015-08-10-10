[2015-08-10 10:01:14,035] INFO [Controller 0]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-08-10 10:01:14,037] DEBUG [Controller 0]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-08-10 10:01:14,037] DEBUG [Controller 0]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 10:01:14,041] TRACE [Controller 0]: All leaders = [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2015-08-10 10:01:14,216] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 10:01:14,217] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:01:14,218] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:01:14,218] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:01:14,218] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:05:42,297] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 10:05:42,317] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 10:05:42,325] INFO [Controller 0]: Initialized controller epoch to 1 and zk version 0 (kafka.controller.KafkaController)
[2015-08-10 10:05:42,331] INFO [Controller 0]: Controller 0 incremented epoch to 2 (kafka.controller.KafkaController)
[2015-08-10 10:05:42,374] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 10:05:42,374] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 10:05:42,375] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 10:05:42,378] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 10:05:42,379] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 10:05:42,380] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 10:05:42,385] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 10:05:42,386] INFO [Controller 0]: List of topics ineligible for deletion: messages (kafka.controller.KafkaController)
[2015-08-10 10:05:42,388] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 10:05:42,389] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 10:05:42,389] INFO [Controller 0]: Current list of topics in the cluster: Set(messages) (kafka.controller.KafkaController)
[2015-08-10 10:05:42,394] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=messages,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:05:42,411] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:05:42,419] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([messages,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:05:42,423] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2015-08-10 10:05:42,424] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 10:05:42,425] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 10:05:42,433] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 10:05:42,434] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 10:05:42,445] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:05:42,477] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:05:42,479] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:05:42,483] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:05:42,484] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:05:42,485] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-08-10 10:05:42,493] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:05:42,510] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [messages,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:05:42,512] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":1,"isr":[0]} for offline partition [messages,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:05:42,517] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:2)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:05:47,436] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:05:47,442] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:05:47,446] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:05:47,447] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:05:55,187] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 10:05:55,210] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 10:05:55,231] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:05:55,245] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 1, deleted brokers: , all live brokers: 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:05:55,245] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:05:55,246] INFO [Controller-0-to-broker-1-send-thread], Controller 0 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:05:55,246] INFO [Controller-0-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:05:55,246] INFO [Controller 0]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 10:06:23,481] INFO [Controller 2]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 10:06:23,501] INFO [Controller 2]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 10:06:23,523] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:06:23,543] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 2, deleted brokers: , all live brokers: 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:06:23,543] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:06:23,544] INFO [Controller-0-to-broker-2-send-thread], Controller 0 connected to id:2,host:localhost.localdomain,port:9094 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:06:23,544] INFO [Controller 0]: New broker startup callback for 2 (kafka.controller.KafkaController)
[2015-08-10 10:06:23,545] INFO [Controller-0-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:07:24,131] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children messages,messages-replicated (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-08-10 10:07:24,137] INFO [TopicChangeListener on Controller 0]: New topics: [Set(messages-replicated)], deleted topics: [Set()], new partition replica assignment [Map([messages-replicated,0] -> List(1, 2, 0))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-08-10 10:07:24,138] INFO [Controller 0]: New topic creation callback for [messages-replicated,0] (kafka.controller.KafkaController)
[2015-08-10 10:07:24,140] INFO [Controller 0]: New partition creation callback for [messages-replicated,0] (kafka.controller.KafkaController)
[2015-08-10 10:07:24,140] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:07:24,146] INFO [Replica state machine on controller 0]: Invoking state change to NewReplica for replicas [Topic=messages-replicated,Partition=0,Replica=1],[Topic=messages-replicated,Partition=0,Replica=2],[Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:07:24,149] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:07:24,150] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [messages-replicated,0] are: [List(1, 2, 0)] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:07:24,151] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [messages-replicated,0] to (Leader:1,ISR:1,2,0,LeaderEpoch:0,ControllerEpoch:2) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:07:24,157] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=1],[Topic=messages-replicated,Partition=0,Replica=2],[Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:20,241] INFO [Controller 0]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-10 10:08:20,243] DEBUG [Controller 0]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 10:08:20,244] DEBUG [Controller 0]: Live brokers: 0,2 (kafka.controller.KafkaController)
[2015-08-10 10:08:20,248] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:20,254] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages-replicated,0] : current leader = 1, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 10:08:20,257] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:2,ISR:2,0,LeaderEpoch:1,ControllerEpoch:2), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:2)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:20,259] TRACE [Controller 0]: All leaders = [messages-replicated,0] -> (Leader:2,ISR:2,0,LeaderEpoch:1,ControllerEpoch:2),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2015-08-10 10:08:20,272] WARN [Controller-0-to-broker-1-send-thread], Controller 0 epoch 2 fails to send request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:2;CorrelationId:14;ClientId:id_0-host_null-port_9092;Leaders:id:2,host:localhost.localdomain,port:9094;PartitionState:(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,0,LeaderEpoch:1,ControllerEpoch:2),ReplicationFactor:3),AllReplicas:1,2,0) to broker id:1,host:localhost.localdomain,port:9093. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.EOFException: Received -1 when reading from channel, socket has likely been closed.
	at kafka.utils.Utils$.read(Utils.scala:381)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:08:20,276] INFO [Controller-0-to-broker-1-send-thread], Controller 0 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:08:20,577] WARN [Controller-0-to-broker-1-send-thread], Controller 0 epoch 2 fails to send request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:2;CorrelationId:14;ClientId:id_0-host_null-port_9092;Leaders:id:2,host:localhost.localdomain,port:9094;PartitionState:(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,0,LeaderEpoch:1,ControllerEpoch:2),ReplicationFactor:3),AllReplicas:1,2,0) to broker id:1,host:localhost.localdomain,port:9093. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:08:20,577] INFO [Controller-0-to-broker-1-send-thread], Controller 0 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:08:20,585] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:08:20,591] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: 1, all live brokers: 0,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:08:20,592] INFO [Controller-0-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:08:20,594] ERROR [Controller-0-to-broker-1-send-thread], Controller 0 fails to send a request to broker id:1,host:localhost.localdomain,port:9093 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:150)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:08:20,595] INFO [Controller-0-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:20,595] INFO [Controller-0-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:08:20,596] INFO [Controller 0]: Broker failure callback for 1 (kafka.controller.KafkaController)
[2015-08-10 10:08:20,597] INFO [Controller 0]: Removed ArrayBuffer(1) from list of shutting down brokers. (kafka.controller.KafkaController)
[2015-08-10 10:08:20,598] INFO [Partition state machine on Controller 0]: Invoking state change to OfflinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:20,599] INFO [Replica state machine on controller 0]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:20,602] DEBUG [Controller 0]: Removing replica 1 from ISR 2,0 for partition [messages-replicated,0]. (kafka.controller.KafkaController)
[2015-08-10 10:08:20,607] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [messages-replicated,0] since it is not in the ISR. Leader = 2 ; ISR = List(2, 0) (kafka.controller.KafkaController)
[2015-08-10 10:08:20,612] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:20,612] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=messages-replicated,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:20,616] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 17; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 2; Partitions: [messages-replicated,0] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:08:35,273] INFO [Controller 0]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-08-10 10:08:35,273] DEBUG [Controller 0]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-08-10 10:08:35,273] DEBUG [Controller 0]: Live brokers: 2 (kafka.controller.KafkaController)
[2015-08-10 10:08:35,274] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:35,274] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:35,274] INFO [Replica state machine on controller 0]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:35,274] DEBUG [Controller 0]: Removing replica 0 from ISR 2,0 for partition [messages-replicated,0]. (kafka.controller.KafkaController)
[2015-08-10 10:08:35,280] INFO [Controller 0]: New leader and ISR for partition [messages-replicated,0] is {"leader":2,"leader_epoch":2,"isr":[2]} (kafka.controller.KafkaController)
[2015-08-10 10:08:35,281] WARN [Channel manager on controller 0]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:2;CorrelationId:19;ClientId:id_0-host_null-port_9092;Leaders:id:2,host:localhost.localdomain,port:9094;PartitionState:(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:2),ReplicationFactor:3),AllReplicas:1,2,0) to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:08:35,281] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:35,282] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:35,282] TRACE [Controller 0]: All leaders = [messages-replicated,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:2),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2015-08-10 10:08:35,286] WARN [Controller-0-to-broker-0-send-thread], Controller 0 epoch 2 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 19; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 2; Partitions: [messages-replicated,0] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.EOFException: Received -1 when reading from channel, socket has likely been closed.
	at kafka.utils.Utils$.read(Utils.scala:381)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:08:35,287] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:08:35,588] WARN [Controller-0-to-broker-0-send-thread], Controller 0 epoch 2 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 19; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 2; Partitions: [messages-replicated,0] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:08:35,589] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:08:35,718] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:35,718] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:35,719] INFO [Controller-0-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:08:35,719] INFO [Controller-0-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:35,719] INFO [Controller-0-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:08:35,720] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:08:35,721] ERROR [Controller-0-to-broker-0-send-thread], Controller 0 fails to send a request to broker id:0,host:localhost.localdomain,port:9092 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:152)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:08:35,721] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:35,721] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:08:35,748] INFO [Controller 2]: Broker 2 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 10:08:35,751] INFO [Controller 2]: Initialized controller epoch to 2 and zk version 1 (kafka.controller.KafkaController)
[2015-08-10 10:08:35,756] INFO [Controller 2]: Controller 2 incremented epoch to 3 (kafka.controller.KafkaController)
[2015-08-10 10:08:35,810] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:08:35,813] INFO [Controller-2-to-broker-2-send-thread], Controller 2 connected to id:2,host:localhost.localdomain,port:9094 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:08:35,814] INFO [Controller-2-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:35,816] INFO [Controller 2]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 10:08:35,817] INFO [Controller 2]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 10:08:35,817] INFO [Controller 2]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 10:08:35,820] INFO [Controller 2]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 10:08:35,820] INFO [Controller 2]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 10:08:35,821] INFO [Controller 2]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 10:08:35,825] INFO [Controller 2]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 10:08:35,825] INFO [Controller 2]: List of topics ineligible for deletion: messages-replicated,messages (kafka.controller.KafkaController)
[2015-08-10 10:08:35,827] INFO [Controller 2]: Currently active brokers in the cluster: Set(2) (kafka.controller.KafkaController)
[2015-08-10 10:08:35,828] INFO [Controller 2]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 10:08:35,828] INFO [Controller 2]: Current list of topics in the cluster: Set(messages, messages-replicated) (kafka.controller.KafkaController)
[2015-08-10 10:08:35,832] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:35,841] INFO [Replica state machine on controller 2]: Started replica state machine with initial state -> Map([Topic=messages,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=2] -> OnlineReplica) (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:35,859] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:08:35,864] INFO [Partition state machine on Controller 2]: Started partition state machine with initial state -> Map([messages-replicated,0] -> OnlinePartition, [messages,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:35,867] INFO [Controller 2]: Broker 2 is ready to serve as the new controller with epoch 3 (kafka.controller.KafkaController)
[2015-08-10 10:08:35,868] INFO [Controller 2]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 10:08:35,868] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:35,872] INFO [Controller 2]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 10:08:40,875] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:08:40,879] DEBUG [Controller 2]: preferred replicas by broker Map(1 -> Map([messages-replicated,0] -> List(1, 2, 0)), 0 -> Map([messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:08:40,882] DEBUG [Controller 2]: topics not in preferred replica Map([messages-replicated,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-08-10 10:08:40,884] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-08-10 10:08:40,886] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:08:40,886] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:08:45,103] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 10:08:45,124] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 10:08:45,145] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 0,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:08:45,168] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: 0, deleted brokers: , all live brokers: 0,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:08:45,168] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:08:45,169] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:08:45,169] INFO [Controller-2-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:45,170] INFO [Controller 2]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-08-10 10:08:45,171] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:45,179] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [messages,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:08:45,179] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":2,"isr":[0]} for offline partition [messages,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:08:45,183] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:2), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:3)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:46,695] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 10:08:46,711] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 10:08:46,738] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:08:46,760] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: 1, deleted brokers: , all live brokers: 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:08:46,760] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:08:46,760] INFO [Controller-2-to-broker-1-send-thread], Controller 2 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:08:46,761] INFO [Controller 2]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 10:08:46,761] INFO [Controller-2-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:46,763] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:52,784] INFO [Controller 2]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-08-10 10:08:52,785] DEBUG [Controller 2]: All shutting down brokers: 2 (kafka.controller.KafkaController)
[2015-08-10 10:08:52,786] DEBUG [Controller 2]: Live brokers: 0,1 (kafka.controller.KafkaController)
[2015-08-10 10:08:52,789] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:52,795] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages-replicated,0] : current leader = 2, new leader = 0 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 10:08:52,797] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,1,LeaderEpoch:3,ControllerEpoch:3), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:3)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:52,800] TRACE [Controller 2]: All leaders = [messages-replicated,0] -> (Leader:0,ISR:0,1,LeaderEpoch:3,ControllerEpoch:3),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:3) (kafka.controller.KafkaController)
[2015-08-10 10:08:53,080] INFO [Partition state machine on Controller 2]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:53,080] INFO [Replica state machine on controller 2]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:53,081] INFO [Controller-2-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,081] INFO [Controller-2-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,081] INFO [Controller-2-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,082] INFO [Controller-2-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,083] INFO [Controller-2-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,083] INFO [Controller-2-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,083] INFO [Controller-2-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,084] INFO [Controller-2-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,084] INFO [Controller-2-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,107] INFO [Controller 1]: Broker 1 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 10:08:53,110] INFO [Controller 1]: Initialized controller epoch to 3 and zk version 2 (kafka.controller.KafkaController)
[2015-08-10 10:08:53,114] INFO [Controller 1]: Controller 1 incremented epoch to 4 (kafka.controller.KafkaController)
[2015-08-10 10:08:53,179] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:08:53,181] INFO [Controller-1-to-broker-0-send-thread], Controller 1 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,181] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:08:53,182] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,183] INFO [Controller-1-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,183] INFO [Controller-1-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:53,187] INFO [Controller 1]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 10:08:53,188] INFO [Controller 1]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 10:08:53,188] INFO [Controller 1]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 10:08:53,192] INFO [Controller 1]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 10:08:53,192] INFO [Controller 1]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 10:08:53,194] INFO [Controller 1]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 10:08:53,199] INFO [Controller 1]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 10:08:53,199] INFO [Controller 1]: List of topics ineligible for deletion: messages-replicated (kafka.controller.KafkaController)
[2015-08-10 10:08:53,202] INFO [Controller 1]: Currently active brokers in the cluster: Set(0, 1) (kafka.controller.KafkaController)
[2015-08-10 10:08:53,202] INFO [Controller 1]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 10:08:53,203] INFO [Controller 1]: Current list of topics in the cluster: Set(messages, messages-replicated) (kafka.controller.KafkaController)
[2015-08-10 10:08:53,209] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages-replicated,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:53,227] INFO [Replica state machine on controller 1]: Started replica state machine with initial state -> Map([Topic=messages,Partition=0,Replica=0] -> OnlineReplica, [Topic=messages-replicated,Partition=0,Replica=0] -> OnlineReplica, [Topic=messages-replicated,Partition=0,Replica=1] -> OnlineReplica, [Topic=messages-replicated,Partition=0,Replica=2] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:53,231] INFO [Partition state machine on Controller 1]: Started partition state machine with initial state -> Map([messages-replicated,0] -> OnlinePartition, [messages,0] -> OnlinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:53,235] INFO [Controller 1]: Broker 1 is ready to serve as the new controller with epoch 4 (kafka.controller.KafkaController)
[2015-08-10 10:08:53,236] INFO [Controller 1]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 10:08:53,237] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:53,242] INFO [Controller 1]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 10:08:58,245] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:08:58,251] DEBUG [Controller 1]: preferred replicas by broker Map(1 -> Map([messages-replicated,0] -> List(1, 2, 0)), 0 -> Map([messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:08:58,255] DEBUG [Controller 1]: topics not in preferred replica Map([messages-replicated,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-08-10 10:08:58,256] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-08-10 10:08:58,257] INFO [Controller 1]: Starting preferred replica leader election for partitions [messages-replicated,0] (kafka.controller.KafkaController)
[2015-08-10 10:08:58,257] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:58,264] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [messages-replicated,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2015-08-10 10:08:58,268] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:0,1,LeaderEpoch:4,ControllerEpoch:4), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:3)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:58,270] WARN [Channel manager on controller 1]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:1;ControllerEpoch:4;CorrelationId:4;ClientId:id_1-host_null-port_9093;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:1,ISR:0,1,LeaderEpoch:4,ControllerEpoch:4),ReplicationFactor:3),AllReplicas:1,2,0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:08:58,273] INFO [Controller 1]: Partition [messages-replicated,0] completed preferred replica leader election. New leader is 1 (kafka.controller.KafkaController)
[2015-08-10 10:08:58,273] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:08:58,273] TRACE [Controller 1]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:08:58,583] INFO [Controller 1]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-08-10 10:08:58,584] DEBUG [Controller 1]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-08-10 10:08:58,585] DEBUG [Controller 1]: Live brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 10:08:58,590] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:58,591] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:58,592] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:58,594] DEBUG [Controller 1]: Removing replica 0 from ISR 0,1 for partition [messages-replicated,0]. (kafka.controller.KafkaController)
[2015-08-10 10:08:58,602] INFO [Controller 1]: New leader and ISR for partition [messages-replicated,0] is {"leader":1,"leader_epoch":5,"isr":[1]} (kafka.controller.KafkaController)
[2015-08-10 10:08:58,605] WARN [Channel manager on controller 1]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:1;ControllerEpoch:4;CorrelationId:6;ClientId:id_1-host_null-port_9093;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:4),ReplicationFactor:3),AllReplicas:1,2,0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:08:58,606] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:58,606] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:58,607] TRACE [Controller 1]: All leaders = [messages-replicated,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:4),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:3) (kafka.controller.KafkaController)
[2015-08-10 10:08:58,619] WARN [Controller-1-to-broker-0-send-thread], Controller 1 epoch 4 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 6; ClientId: ; DeletePartitions: false; ControllerId: 1; ControllerEpoch: 4; Partitions: [messages-replicated,0] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.EOFException: Received -1 when reading from channel, socket has likely been closed.
	at kafka.utils.Utils$.read(Utils.scala:381)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:08:58,623] INFO [Controller-1-to-broker-0-send-thread], Controller 1 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:08:58,924] WARN [Controller-1-to-broker-0-send-thread], Controller 1 epoch 4 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 6; ClientId: ; DeletePartitions: false; ControllerId: 1; ControllerEpoch: 4; Partitions: [messages-replicated,0] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:08:58,926] INFO [Controller-1-to-broker-0-send-thread], Controller 1 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:08:59,146] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:08:59,158] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: , deleted brokers: 0, all live brokers: 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:08:59,159] INFO [Controller-1-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:08:59,161] ERROR [Controller-1-to-broker-0-send-thread], Controller 1 fails to send a request to broker id:0,host:localhost.localdomain,port:9092 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:152)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:08:59,161] INFO [Controller-1-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:08:59,161] INFO [Controller-1-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:08:59,162] INFO [Controller 1]: Broker failure callback for 0 (kafka.controller.KafkaController)
[2015-08-10 10:08:59,163] INFO [Controller 1]: Removed ArrayBuffer(0) from list of shutting down brokers. (kafka.controller.KafkaController)
[2015-08-10 10:08:59,164] INFO [Partition state machine on Controller 1]: Invoking state change to OfflinePartition for partitions [messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:08:59,177] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:08:59,179] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:08:59,180] DEBUG [Controller 1]: Removing replica 0 from ISR 1 for partition [messages-replicated,0]. (kafka.controller.KafkaController)
[2015-08-10 10:08:59,184] WARN [Controller 1]: Cannot remove replica 0 from ISR of partition [messages-replicated,0] since it is not in the ISR. Leader = 1 ; ISR = List(1) (kafka.controller.KafkaController)
[2015-08-10 10:08:59,185] DEBUG [Controller 1]: Removing replica 0 from ISR 0 for partition [messages,0]. (kafka.controller.KafkaController)
[2015-08-10 10:08:59,193] INFO [Controller 1]: New leader and ISR for partition [messages,0] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-08-10 10:08:59,194] WARN [Channel manager on controller 1]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:1;ControllerEpoch:4;CorrelationId:9;ClientId:id_1-host_null-port_9093;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:4),ReplicationFactor:3),AllReplicas:1,2,0) to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:08:59,194] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:59,195] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:08:59,195] WARN [Channel manager on controller 1]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 9; ClientId: ; DeletePartitions: false; ControllerId: 1; ControllerEpoch: 4; Partitions: [messages-replicated,0] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:08:59,195] WARN [Channel manager on controller 1]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 9; ClientId: ; DeletePartitions: false; ControllerId: 1; ControllerEpoch: 4; Partitions: [messages,0] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:09:05,632] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 10:09:05,650] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 10:09:05,673] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:09:05,684] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 0, deleted brokers: , all live brokers: 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:09:05,685] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:09:05,685] INFO [Controller-1-to-broker-0-send-thread], Controller 1 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:09:05,685] INFO [Controller-1-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:09:05,686] INFO [Controller 1]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-08-10 10:09:05,687] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:09:05,698] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:09:05,699] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:09:05,700] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":4,"isr":[0]} for offline partition [messages,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:09:05,702] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:4), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:4)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:09:07,166] INFO [Controller 2]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 10:09:07,192] INFO [Controller 2]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 10:09:07,215] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:09:07,229] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 2, deleted brokers: , all live brokers: 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:09:07,230] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:09:07,230] INFO [Controller-1-to-broker-2-send-thread], Controller 1 connected to id:2,host:localhost.localdomain,port:9094 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:09:07,230] INFO [Controller 1]: New broker startup callback for 2 (kafka.controller.KafkaController)
[2015-08-10 10:09:07,230] INFO [Controller-1-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:09:07,231] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:09:13,758] INFO [Controller 1]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-10 10:09:13,759] DEBUG [Controller 1]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 10:09:13,759] DEBUG [Controller 1]: Live brokers: 0,2 (kafka.controller.KafkaController)
[2015-08-10 10:09:13,759] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:09:13,763] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages-replicated,0] : current leader = 1, new leader = 0 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 10:09:13,765] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:0,ISR:0,2,LeaderEpoch:6,ControllerEpoch:4), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:4)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:09:13,766] TRACE [Controller 1]: All leaders = [messages-replicated,0] -> (Leader:0,ISR:0,2,LeaderEpoch:6,ControllerEpoch:4),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:4) (kafka.controller.KafkaController)
[2015-08-10 10:09:13,944] INFO [Partition state machine on Controller 1]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 10:09:13,944] INFO [Replica state machine on controller 1]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:09:13,945] INFO [Controller-1-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:09:13,945] WARN [Controller-1-to-broker-2-send-thread], Controller 1 epoch 4 fails to send request Name:LeaderAndIsrRequest;Version:0;Controller:1;ControllerEpoch:4;CorrelationId:16;ClientId:id_1-host_null-port_9093;Leaders:id:0,host:localhost.localdomain,port:9092;PartitionState:(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:0,ISR:0,2,LeaderEpoch:6,ControllerEpoch:4),ReplicationFactor:3),AllReplicas:1,2,0) to broker id:2,host:localhost.localdomain,port:9094. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.AsynchronousCloseException
	at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:205)
	at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:387)
	at kafka.utils.Utils$.read(Utils.scala:380)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:09:13,947] INFO [Controller-1-to-broker-2-send-thread], Controller 1 connected to id:2,host:localhost.localdomain,port:9094 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:09:13,948] ERROR [Controller-1-to-broker-2-send-thread], Controller 1 fails to send a request to broker id:2,host:localhost.localdomain,port:9094 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:150)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:09:13,948] INFO [Controller-1-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:09:13,948] INFO [Controller-1-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:09:13,948] INFO [Controller-1-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:09:13,949] INFO [Controller-1-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:09:13,949] INFO [Controller-1-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:09:13,949] INFO [Controller-1-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:09:13,949] INFO [Controller-1-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:09:13,949] INFO [Controller-1-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:09:13,966] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 10:09:13,969] INFO [Controller 0]: Initialized controller epoch to 4 and zk version 3 (kafka.controller.KafkaController)
[2015-08-10 10:09:13,973] INFO [Controller 0]: Controller 0 incremented epoch to 5 (kafka.controller.KafkaController)
[2015-08-10 10:09:14,034] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:09:14,037] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:09:14,038] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:09:14,038] INFO [Controller-0-to-broker-2-send-thread], Controller 0 connected to id:2,host:localhost.localdomain,port:9094 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:09:14,039] INFO [Controller-0-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:09:14,039] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:09:14,041] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 10:09:14,042] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 10:09:14,042] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 10:09:14,046] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 10:09:14,046] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 10:09:14,047] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 10:09:14,052] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 10:09:14,053] INFO [Controller 0]: List of topics ineligible for deletion: messages-replicated (kafka.controller.KafkaController)
[2015-08-10 10:09:14,055] INFO [Controller 0]: Currently active brokers in the cluster: Set(0, 2) (kafka.controller.KafkaController)
[2015-08-10 10:09:14,056] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 10:09:14,056] INFO [Controller 0]: Current list of topics in the cluster: Set(messages, messages-replicated) (kafka.controller.KafkaController)
[2015-08-10 10:09:14,060] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages-replicated,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:09:14,072] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=messages,Partition=0,Replica=0] -> OnlineReplica, [Topic=messages-replicated,Partition=0,Replica=0] -> OnlineReplica, [Topic=messages-replicated,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=2] -> OnlineReplica) (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:09:14,076] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([messages-replicated,0] -> OnlinePartition, [messages,0] -> OnlinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:09:14,079] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 5 (kafka.controller.KafkaController)
[2015-08-10 10:09:14,081] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 10:09:14,081] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 10:09:14,086] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 10:09:19,063] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 10:09:19,083] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 10:09:19,087] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:09:19,090] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([messages-replicated,0] -> List(1, 2, 0)), 0 -> Map([messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:09:19,093] DEBUG [Controller 0]: topics not in preferred replica Map([messages-replicated,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-08-10 10:09:19,095] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-08-10 10:09:19,096] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:09:19,096] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:09:19,110] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:09:19,136] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 1, deleted brokers: , all live brokers: 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:09:19,137] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:09:19,137] INFO [Controller-0-to-broker-1-send-thread], Controller 0 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:09:19,138] INFO [Controller-0-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:09:19,138] INFO [Controller 0]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 10:09:19,140] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:10:31,391] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children messages,messages-replicated,messages-replicated-part3 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-08-10 10:10:31,398] INFO [TopicChangeListener on Controller 0]: New topics: [Set(messages-replicated-part3)], deleted topics: [Set()], new partition replica assignment [Map([messages-replicated-part3,0] -> List(2, 0, 1), [messages-replicated-part3,1] -> List(0, 1, 2), [messages-replicated-part3,2] -> List(1, 2, 0))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-08-10 10:10:31,399] INFO [Controller 0]: New topic creation callback for [messages-replicated-part3,0],[messages-replicated-part3,1],[messages-replicated-part3,2] (kafka.controller.KafkaController)
[2015-08-10 10:10:31,401] INFO [Controller 0]: New partition creation callback for [messages-replicated-part3,0],[messages-replicated-part3,1],[messages-replicated-part3,2] (kafka.controller.KafkaController)
[2015-08-10 10:10:31,401] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [messages-replicated-part3,0],[messages-replicated-part3,1],[messages-replicated-part3,2] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:10:31,426] INFO [Replica state machine on controller 0]: Invoking state change to NewReplica for replicas [Topic=messages-replicated-part3,Partition=1,Replica=1],[Topic=messages-replicated-part3,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=2,Replica=1],[Topic=messages-replicated-part3,Partition=1,Replica=2],[Topic=messages-replicated-part3,Partition=0,Replica=2],[Topic=messages-replicated-part3,Partition=1,Replica=0],[Topic=messages-replicated-part3,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=2,Replica=2],[Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:10:31,433] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,0],[messages-replicated-part3,1],[messages-replicated-part3,2] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:10:31,435] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [messages-replicated-part3,0] are: [List(2, 0, 1)] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:10:31,435] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [messages-replicated-part3,0] to (Leader:2,ISR:2,0,1,LeaderEpoch:0,ControllerEpoch:5) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:10:31,441] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [messages-replicated-part3,1] are: [List(0, 1, 2)] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:10:31,442] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [messages-replicated-part3,1] to (Leader:0,ISR:0,1,2,LeaderEpoch:0,ControllerEpoch:5) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:10:31,445] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [messages-replicated-part3,2] are: [List(1, 2, 0)] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:10:31,445] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [messages-replicated-part3,2] to (Leader:1,ISR:1,2,0,LeaderEpoch:0,ControllerEpoch:5) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:10:31,456] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated-part3,Partition=1,Replica=1],[Topic=messages-replicated-part3,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=2,Replica=1],[Topic=messages-replicated-part3,Partition=1,Replica=2],[Topic=messages-replicated-part3,Partition=0,Replica=2],[Topic=messages-replicated-part3,Partition=1,Replica=0],[Topic=messages-replicated-part3,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=2,Replica=2],[Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:11:21,693] INFO [Controller 0]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-08-10 10:11:21,695] DEBUG [Controller 0]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-08-10 10:11:21,695] DEBUG [Controller 0]: Live brokers: 1,2 (kafka.controller.KafkaController)
[2015-08-10 10:11:21,702] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:11:21,702] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:11:21,705] INFO [Replica state machine on controller 0]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:11:21,706] DEBUG [Controller 0]: Removing replica 0 from ISR 1,2,0 for partition [messages-replicated-part3,2]. (kafka.controller.KafkaController)
[2015-08-10 10:11:21,711] INFO [Controller 0]: New leader and ISR for partition [messages-replicated-part3,2] is {"leader":1,"leader_epoch":1,"isr":[1,2]} (kafka.controller.KafkaController)
[2015-08-10 10:11:21,713] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:11:21,714] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:11:21,714] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:11:21,723] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages-replicated,0] : current leader = 0, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 10:11:21,726] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:2,ISR:2,1,LeaderEpoch:7,ControllerEpoch:5), [messages-replicated-part3,0] -> (Leader:2,ISR:2,0,1,LeaderEpoch:0,ControllerEpoch:5), [messages-replicated-part3,1] -> (Leader:0,ISR:0,1,2,LeaderEpoch:0,ControllerEpoch:5), [messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:5), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:4)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:11:21,727] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,1] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:11:21,731] DEBUG [ControlledShutdownLeaderSelector]: Partition [messages-replicated-part3,1] : current leader = 0, new leader = 1 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-08-10 10:11:21,733] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:2,ISR:2,1,LeaderEpoch:7,ControllerEpoch:5), [messages-replicated-part3,0] -> (Leader:2,ISR:2,0,1,LeaderEpoch:0,ControllerEpoch:5), [messages-replicated-part3,1] -> (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:5), [messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:5), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:4)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:11:21,735] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:11:21,735] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:11:21,738] INFO [Replica state machine on controller 0]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated-part3,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:11:21,738] DEBUG [Controller 0]: Removing replica 0 from ISR 2,0,1 for partition [messages-replicated-part3,0]. (kafka.controller.KafkaController)
[2015-08-10 10:11:21,741] INFO [Controller 0]: New leader and ISR for partition [messages-replicated-part3,0] is {"leader":2,"leader_epoch":1,"isr":[2,1]} (kafka.controller.KafkaController)
[2015-08-10 10:11:21,742] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:11:21,742] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:11:21,743] TRACE [Controller 0]: All leaders = [messages-replicated-part3,0] -> (Leader:2,ISR:2,1,LeaderEpoch:1,ControllerEpoch:5),[messages-replicated,0] -> (Leader:2,ISR:2,1,LeaderEpoch:7,ControllerEpoch:5),[messages-replicated-part3,1] -> (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:5),[messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:5),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:4) (kafka.controller.KafkaController)
[2015-08-10 10:11:21,752] WARN [Controller-0-to-broker-0-send-thread], Controller 0 epoch 5 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 12; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 5; Partitions: [messages-replicated-part3,2] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.EOFException: Received -1 when reading from channel, socket has likely been closed.
	at kafka.utils.Utils$.read(Utils.scala:381)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:11:21,755] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,057] WARN [Controller-0-to-broker-0-send-thread], Controller 0 epoch 5 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 12; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 5; Partitions: [messages-replicated-part3,2] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:11:22,058] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,357] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 10:11:22,357] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:11:22,358] INFO [Controller-0-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,358] INFO [Controller-0-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,358] INFO [Controller-0-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,359] INFO [Controller-0-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,359] INFO [Controller-0-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,359] WARN [Controller-0-to-broker-0-send-thread], Controller 0 epoch 5 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 12; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 5; Partitions: [messages-replicated-part3,2] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:11:22,359] INFO [Controller-0-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,361] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,361] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,362] ERROR [Controller-0-to-broker-0-send-thread], Controller 0 fails to send a request to broker id:0,host:localhost.localdomain,port:9092 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:152)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:11:22,363] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,363] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,369] INFO [Controller 2]: Broker 2 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 10:11:22,372] INFO [Controller 2]: Initialized controller epoch to 5 and zk version 4 (kafka.controller.KafkaController)
[2015-08-10 10:11:22,374] INFO [Controller 2]: Controller 2 incremented epoch to 6 (kafka.controller.KafkaController)
[2015-08-10 10:11:22,448] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:11:22,450] INFO [Controller-2-to-broker-1-send-thread], Controller 2 connected to id:1,host:localhost.localdomain,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,451] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:11:22,451] INFO [Controller-2-to-broker-2-send-thread], Controller 2 connected to id:2,host:localhost.localdomain,port:9094 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,453] INFO [Controller-2-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,453] INFO [Controller-2-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:11:22,455] INFO [Controller 2]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 10:11:22,455] INFO [Controller 2]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 10:11:22,455] INFO [Controller 2]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 10:11:22,458] INFO [Controller 2]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 10:11:22,459] INFO [Controller 2]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 10:11:22,460] INFO [Controller 2]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 10:11:22,465] INFO [Controller 2]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 10:11:22,466] INFO [Controller 2]: List of topics ineligible for deletion: messages-replicated,messages-replicated-part3,messages (kafka.controller.KafkaController)
[2015-08-10 10:11:22,469] INFO [Controller 2]: Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2015-08-10 10:11:22,469] INFO [Controller 2]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 10:11:22,470] INFO [Controller 2]: Current list of topics in the cluster: Set(messages, messages-replicated, messages-replicated-part3) (kafka.controller.KafkaController)
[2015-08-10 10:11:22,476] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=1],[Topic=messages-replicated,Partition=0,Replica=2],[Topic=messages-replicated-part3,Partition=1,Replica=1],[Topic=messages-replicated-part3,Partition=0,Replica=1],[Topic=messages-replicated-part3,Partition=2,Replica=1],[Topic=messages-replicated-part3,Partition=1,Replica=2],[Topic=messages-replicated-part3,Partition=0,Replica=2],[Topic=messages-replicated-part3,Partition=2,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:11:22,494] INFO [Replica state machine on controller 2]: Started replica state machine with initial state -> Map([Topic=messages-replicated-part3,Partition=0,Replica=2] -> OnlineReplica, [Topic=messages,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=2,Replica=1] -> OnlineReplica, [Topic=messages-replicated-part3,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated,Partition=0,Replica=1] -> OnlineReplica, [Topic=messages-replicated-part3,Partition=1,Replica=2] -> OnlineReplica, [Topic=messages-replicated,Partition=0,Replica=2] -> OnlineReplica, [Topic=messages-replicated-part3,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=messages-replicated-part3,Partition=0,Replica=1] -> OnlineReplica, [Topic=messages-replicated-part3,Partition=1,Replica=1] -> OnlineReplica, [Topic=messages-replicated-part3,Partition=2,Replica=2] -> OnlineReplica) (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:11:22,513] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:11:22,519] INFO [Partition state machine on Controller 2]: Started partition state machine with initial state -> Map([messages-replicated,0] -> OnlinePartition, [messages-replicated-part3,0] -> OnlinePartition, [messages-replicated-part3,1] -> OnlinePartition, [messages-replicated-part3,2] -> OnlinePartition, [messages,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:11:22,523] INFO [Controller 2]: Broker 2 is ready to serve as the new controller with epoch 6 (kafka.controller.KafkaController)
[2015-08-10 10:11:22,524] INFO [Controller 2]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 10:11:22,525] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 10:11:22,530] INFO [Controller 2]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 10:11:27,533] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:11:27,537] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:11:27,539] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:11:27,541] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:11:27,541] DEBUG [Controller 2]: topics not in preferred replica Map([messages-replicated,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-08-10 10:11:27,541] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.500000 (kafka.controller.KafkaController)
[2015-08-10 10:11:27,542] INFO [Controller 2]: Starting preferred replica leader election for partitions [messages-replicated,0] (kafka.controller.KafkaController)
[2015-08-10 10:11:27,542] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:11:27,550] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [messages-replicated,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2015-08-10 10:11:27,554] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:2,1,LeaderEpoch:8,ControllerEpoch:6), [messages-replicated-part3,0] -> (Leader:2,ISR:2,1,0,LeaderEpoch:1,ControllerEpoch:5), [messages-replicated-part3,1] -> (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:5), [messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:5), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:4)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:11:27,557] WARN [Channel manager on controller 2]: Not sending request Name:LeaderAndIsrRequest;Version:0;Controller:2;ControllerEpoch:6;CorrelationId:4;ClientId:id_2-host_null-port_9094;Leaders:id:1,host:localhost.localdomain,port:9093;PartitionState:(messages-replicated,0) -> (LeaderAndIsrInfo:(Leader:1,ISR:2,1,LeaderEpoch:8,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:1,2,0) to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:11:27,558] INFO [Controller 2]: Partition [messages-replicated,0] completed preferred replica leader election. New leader is 1 (kafka.controller.KafkaController)
[2015-08-10 10:11:27,559] DEBUG [Controller 2]: topics not in preferred replica Map([messages-replicated-part3,1] -> List(0, 1, 2)) (kafka.controller.KafkaController)
[2015-08-10 10:11:27,559] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.500000 (kafka.controller.KafkaController)
[2015-08-10 10:12:51,732] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 10:12:51,750] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 10:12:51,768] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:12:51,786] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: 0, deleted brokers: , all live brokers: 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:12:51,787] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:12:51,787] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:12:51,788] INFO [Controller-2-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:12:51,789] INFO [Controller 2]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-08-10 10:12:51,791] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=1,Replica=0],[Topic=messages-replicated-part3,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:12:51,798] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [messages,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:12:51,799] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":5,"isr":[0]} for offline partition [messages,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:12:51,800] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:2,1,LeaderEpoch:8,ControllerEpoch:6), [messages-replicated-part3,0] -> (Leader:2,ISR:2,1,0,LeaderEpoch:1,ControllerEpoch:5), [messages-replicated-part3,1] -> (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:5), [messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:5), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:12:56,052] INFO [Controller 2]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-08-10 10:12:56,053] DEBUG [Controller 2]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-08-10 10:12:56,053] DEBUG [Controller 2]: Live brokers: 1,2 (kafka.controller.KafkaController)
[2015-08-10 10:12:56,061] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,062] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,065] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:12:56,066] DEBUG [Controller 2]: Removing replica 0 from ISR 1,2 for partition [messages-replicated-part3,2]. (kafka.controller.KafkaController)
[2015-08-10 10:12:56,071] INFO [Controller 2]: New leader and ISR for partition [messages-replicated-part3,2] is {"leader":1,"leader_epoch":2,"isr":[1,2]} (kafka.controller.KafkaController)
[2015-08-10 10:12:56,073] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,073] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,073] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,073] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,074] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:12:56,074] DEBUG [Controller 2]: Removing replica 0 from ISR 2,1 for partition [messages-replicated,0]. (kafka.controller.KafkaController)
[2015-08-10 10:12:56,078] INFO [Controller 2]: New leader and ISR for partition [messages-replicated,0] is {"leader":1,"leader_epoch":9,"isr":[2,1]} (kafka.controller.KafkaController)
[2015-08-10 10:12:56,080] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,080] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,080] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,080] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=1,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,080] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated-part3,Partition=1,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:12:56,080] DEBUG [Controller 2]: Removing replica 0 from ISR 1,2 for partition [messages-replicated-part3,1]. (kafka.controller.KafkaController)
[2015-08-10 10:12:56,086] INFO [Controller 2]: New leader and ISR for partition [messages-replicated-part3,1] is {"leader":1,"leader_epoch":2,"isr":[1,2]} (kafka.controller.KafkaController)
[2015-08-10 10:12:56,088] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,088] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=1,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,088] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,088] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,088] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated-part3,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:12:56,088] DEBUG [Controller 2]: Removing replica 0 from ISR 2,1,0 for partition [messages-replicated-part3,0]. (kafka.controller.KafkaController)
[2015-08-10 10:12:56,094] INFO [Controller 2]: New leader and ISR for partition [messages-replicated-part3,0] is {"leader":2,"leader_epoch":2,"isr":[2,1]} (kafka.controller.KafkaController)
[2015-08-10 10:12:56,095] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,095] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated-part3,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:56,096] TRACE [Controller 2]: All leaders = [messages-replicated-part3,0] -> (Leader:2,ISR:2,1,LeaderEpoch:2,ControllerEpoch:6),[messages-replicated,0] -> (Leader:1,ISR:2,1,LeaderEpoch:9,ControllerEpoch:6),[messages-replicated-part3,1] -> (Leader:1,ISR:1,2,LeaderEpoch:2,ControllerEpoch:6),[messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:2,ControllerEpoch:6),[messages,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:6) (kafka.controller.KafkaController)
[2015-08-10 10:12:56,107] WARN [Controller-2-to-broker-0-send-thread], Controller 2 epoch 6 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 13; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,1] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.EOFException: Received -1 when reading from channel, socket has likely been closed.
	at kafka.utils.Utils$.read(Utils.scala:381)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:12:56,108] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:12:56,409] WARN [Controller-2-to-broker-0-send-thread], Controller 2 epoch 6 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 13; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,1] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:12:56,410] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:12:56,711] WARN [Controller-2-to-broker-0-send-thread], Controller 2 epoch 6 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 13; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,1] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:12:56,712] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:12:57,013] WARN [Controller-2-to-broker-0-send-thread], Controller 2 epoch 6 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 13; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,1] to broker id:0,host:localhost.localdomain,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:12:57,014] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:12:57,042] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:12:57,051] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: , deleted brokers: 0, all live brokers: 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:12:57,051] INFO [Controller-2-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 10:12:57,053] ERROR [Controller-2-to-broker-0-send-thread], Controller 2 fails to send a request to broker id:0,host:localhost.localdomain,port:9092 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:152)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-10 10:12:57,053] INFO [Controller-2-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 10:12:57,053] INFO [Controller-2-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 10:12:57,055] INFO [Controller 2]: Broker failure callback for 0 (kafka.controller.KafkaController)
[2015-08-10 10:12:57,056] INFO [Controller 2]: Removed ArrayBuffer(0) from list of shutting down brokers. (kafka.controller.KafkaController)
[2015-08-10 10:12:57,057] INFO [Partition state machine on Controller 2]: Invoking state change to OfflinePartition for partitions [messages,0] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:12:57,066] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:12:57,067] INFO [Replica state machine on controller 2]: Invoking state change to OfflineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=1,Replica=0],[Topic=messages-replicated-part3,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:12:57,068] DEBUG [Controller 2]: Removing replica 0 from ISR 2,1 for partition [messages-replicated,0]. (kafka.controller.KafkaController)
[2015-08-10 10:12:57,072] WARN [Controller 2]: Cannot remove replica 0 from ISR of partition [messages-replicated,0] since it is not in the ISR. Leader = 1 ; ISR = List(2, 1) (kafka.controller.KafkaController)
[2015-08-10 10:12:57,072] DEBUG [Controller 2]: Removing replica 0 from ISR 0 for partition [messages,0]. (kafka.controller.KafkaController)
[2015-08-10 10:12:57,078] INFO [Controller 2]: New leader and ISR for partition [messages,0] is {"leader":-1,"leader_epoch":6,"isr":[]} (kafka.controller.KafkaController)
[2015-08-10 10:12:57,078] DEBUG [Controller 2]: Removing replica 0 from ISR 1,2 for partition [messages-replicated-part3,1]. (kafka.controller.KafkaController)
[2015-08-10 10:12:57,080] WARN [Controller 2]: Cannot remove replica 0 from ISR of partition [messages-replicated-part3,1] since it is not in the ISR. Leader = 1 ; ISR = List(1, 2) (kafka.controller.KafkaController)
[2015-08-10 10:12:57,080] DEBUG [Controller 2]: Removing replica 0 from ISR 2,1 for partition [messages-replicated-part3,0]. (kafka.controller.KafkaController)
[2015-08-10 10:12:57,083] INFO [Controller 2]: New leader and ISR for partition [messages-replicated-part3,0] is {"leader":2,"leader_epoch":3,"isr":[2,1]} (kafka.controller.KafkaController)
[2015-08-10 10:12:57,084] DEBUG [Controller 2]: Removing replica 0 from ISR 1,2 for partition [messages-replicated-part3,2]. (kafka.controller.KafkaController)
[2015-08-10 10:12:57,086] WARN [Controller 2]: Cannot remove replica 0 from ISR of partition [messages-replicated-part3,2] since it is not in the ISR. Leader = 1 ; ISR = List(1, 2) (kafka.controller.KafkaController)
[2015-08-10 10:12:57,088] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:57,088] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=1,Replica=0],[Topic=messages-replicated-part3,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2015-08-10 10:12:57,088] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 18; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated,0] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:12:57,088] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 18; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages,0] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:12:57,089] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 18; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,1] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:12:57,089] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 18; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,0] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:12:57,089] WARN [Channel manager on controller 2]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 18; ClientId: ; DeletePartitions: false; ControllerId: 2; ControllerEpoch: 6; Partitions: [messages-replicated-part3,2] to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-08-10 10:14:14,294] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 10:14:14,316] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 10:14:14,333] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:14:14,344] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: 0, deleted brokers: , all live brokers: 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 10:14:14,345] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-08-10 10:14:14,345] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:localhost.localdomain,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 10:14:14,346] INFO [Controller 2]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-08-10 10:14:14,346] INFO [Controller-2-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 10:14:14,347] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=messages-replicated,Partition=0,Replica=0],[Topic=messages,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=1,Replica=0],[Topic=messages-replicated-part3,Partition=0,Replica=0],[Topic=messages-replicated-part3,Partition=2,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-08-10 10:14:14,357] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:14:14,358] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [messages,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:14:14,358] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":7,"isr":[0]} for offline partition [messages,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 10:14:14,359] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:2,1,LeaderEpoch:9,ControllerEpoch:6), [messages-replicated-part3,0] -> (Leader:2,ISR:2,1,LeaderEpoch:3,ControllerEpoch:6), [messages-replicated-part3,1] -> (Leader:1,ISR:1,2,LeaderEpoch:2,ControllerEpoch:6), [messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:2,ControllerEpoch:6), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:16:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:16:27,531] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:16:27,531] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:16:27,531] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:16:27,531] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:16:27,531] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:16:27,531] DEBUG [Controller 2]: topics not in preferred replica Map([messages-replicated-part3,1] -> List(0, 1, 2)) (kafka.controller.KafkaController)
[2015-08-10 10:16:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.500000 (kafka.controller.KafkaController)
[2015-08-10 10:16:27,532] INFO [Controller 2]: Starting preferred replica leader election for partitions [messages-replicated-part3,1] (kafka.controller.KafkaController)
[2015-08-10 10:16:27,532] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [messages-replicated-part3,1] (kafka.controller.PartitionStateMachine)
[2015-08-10 10:16:27,534] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [messages-replicated-part3,1] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2015-08-10 10:16:27,536] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([messages-replicated,0] -> (Leader:1,ISR:2,1,LeaderEpoch:9,ControllerEpoch:6), [messages-replicated-part3,0] -> (Leader:2,ISR:2,1,LeaderEpoch:3,ControllerEpoch:6), [messages-replicated-part3,1] -> (Leader:0,ISR:1,2,0,LeaderEpoch:3,ControllerEpoch:6), [messages-replicated-part3,2] -> (Leader:1,ISR:1,2,LeaderEpoch:2,ControllerEpoch:6), [messages,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-08-10 10:16:27,536] INFO [Controller 2]: Partition [messages-replicated-part3,1] completed preferred replica leader election. New leader is 0 (kafka.controller.KafkaController)
[2015-08-10 10:21:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:21:27,532] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:21:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:21:27,533] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:21:27,533] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:21:27,533] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:21:27,533] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:21:27,534] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:26:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:26:27,532] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:26:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:26:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:26:27,533] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:26:27,533] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:26:27,533] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:26:27,533] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:31:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:31:27,532] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:31:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:31:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:31:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:31:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:31:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:31:27,533] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:36:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:36:27,532] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:36:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:36:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:36:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:36:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:36:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:36:27,533] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:41:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:41:27,531] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:41:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:41:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:41:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:41:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:41:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:41:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:46:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:46:27,531] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:46:27,531] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:46:27,531] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:46:27,531] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:46:27,531] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:46:27,531] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:46:27,531] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:51:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:51:27,532] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:51:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:51:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:51:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:51:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:51:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:51:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:56:27,531] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 10:56:27,531] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([messages-replicated-part3,0] -> List(2, 0, 1)), 1 -> Map([messages-replicated,0] -> List(1, 2, 0), [messages-replicated-part3,2] -> List(1, 2, 0)), 0 -> Map([messages-replicated-part3,1] -> List(0, 1, 2), [messages,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 10:56:27,531] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:56:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:56:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:56:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 10:56:27,532] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 10:56:27,532] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
